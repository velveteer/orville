<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module    : Database.Orville.PostgreSQL.Internal.Monad
Copyright : Flipstone Technology Partners 2016-2018
License   : MIT

'Database.Orville.PostgreSQL.MonadBaseControl' provides functions and instances for
using 'MonadOrville' and 'OrvilleT' for situations where you need to use
'MonadBaseControl'. If you do not know if you need 'MonadBaseControl', then
you probably don't need to use this module. If you are thinking about
using 'MonadBaseControl' instead of 'MonadUnliftIO', we recommend
reading Michael Snoyman's excellent &quot;A Tale of Two Brackets&quot;
(https://www.fpcomplete.com/blog/2017/06/tale-of-two-brackets) if you
have not already done so.

If you're still here after reading above, this module provides
the functions you need to implement 'MonadOrvilleControl' for your
Monad stack using its 'MonadBaseControl' instance. The most common way
to do this is simply to add the following 'MonadOrvilleControl' instance:

@
 instance MonadOrvilleControl MyMonad where
   liftWithConnection = liftWithConnectionViaBaseControl
   liftFinally = liftFinallyViaBaseControl
@

This module also provides a 'MonadOrvilleControl' for 'StateT' as well as
'MonadBaseControl' and 'MonadTransControl' instances for 'OrvilleT' and
'OrvilleTriggerT'.
-}</span><span>
</span><a name="line-30"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-31"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-32"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><a name="line-33"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><a name="line-34"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Orville.PostgreSQL.MonadBaseControl</span><span>
</span><a name="line-37"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Database.Orville.PostgreSQL.MonadBaseControl.html#liftWithConnectionViaBaseControl"><span class="hs-identifier hs-var">liftWithConnectionViaBaseControl</span></a><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Database.Orville.PostgreSQL.MonadBaseControl.html#liftFinallyViaBaseControl"><span class="hs-identifier hs-var">liftFinallyViaBaseControl</span></a><span>
</span><a name="line-39"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.Reader</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.State</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StateT</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control.Monad.Trans.Control</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">MTC</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.Orville.PostgreSQL.html"><span class="hs-identifier">Database.Orville.PostgreSQL</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">O</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.Monad</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">InternalMonad</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Trigger.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Internal.Trigger</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">InternalTrigger</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Database.Orville.PostgreSQL.Trigger.html"><span class="hs-identifier">Database.Orville.PostgreSQL.Trigger</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">OT</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span class="hs-comment">{-|
   liftWithConnectionViaBaseControl can be use as the implementation of
   'liftWithConnection' for 'MonadOrvilleControl' when the 'Monad'
   implements 'MonadBaseControl'.
 -}</span><span>
</span><a name="line-55"></a><span class="hs-identifier">liftWithConnectionViaBaseControl</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-56"></a><span>     </span><span class="hs-identifier hs-type">MTC.MonadBaseControl</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679152457"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-57"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679152460"><a href="#local-6989586621679152460"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152458"><span class="hs-identifier hs-type">conn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679152460"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679152460"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152458"><span class="hs-identifier hs-type">conn</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152457"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679152459"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152457"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679152459"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-60"></a><a name="liftWithConnectionViaBaseControl"><a href="Database.Orville.PostgreSQL.MonadBaseControl.html#liftWithConnectionViaBaseControl"><span class="hs-identifier">liftWithConnectionViaBaseControl</span></a></a><span> </span><a name="local-6989586621679152461"><a href="#local-6989586621679152461"><span class="hs-identifier">ioWithConn</span></a></a><span> </span><a name="local-6989586621679152462"><a href="#local-6989586621679152462"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-61"></a><span>  </span><span class="hs-identifier hs-var">MTC.control</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152463"><a href="#local-6989586621679152463"><span class="hs-identifier">runInIO</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152461"><span class="hs-identifier hs-var">ioWithConn</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152463"><span class="hs-identifier hs-var">runInIO</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679152462"><span class="hs-identifier hs-var">action</span></a><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-comment">{-|
   liftFinallyViaBaseControl can be use as the implementation of
   'liftFinally for 'MonadOrvilleControl' when the 'Monad'
   implements 'MonadBaseControl'.
 -}</span><span>
</span><a name="line-68"></a><span class="hs-identifier">liftFinallyViaBaseControl</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-69"></a><span>     </span><span class="hs-identifier hs-type">MTC.MonadBaseControl</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679152452"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-70"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679152455"><a href="#local-6989586621679152455"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679152456"><a href="#local-6989586621679152456"><span class="hs-identifier">d</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679152455"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679152456"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679152455"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152452"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679152453"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-72"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152452"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679152454"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-73"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152452"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679152453"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-74"></a><a name="liftFinallyViaBaseControl"><a href="Database.Orville.PostgreSQL.MonadBaseControl.html#liftFinallyViaBaseControl"><span class="hs-identifier">liftFinallyViaBaseControl</span></a></a><span> </span><a name="local-6989586621679152464"><a href="#local-6989586621679152464"><span class="hs-identifier">ioFinally</span></a></a><span> </span><a name="local-6989586621679152465"><a href="#local-6989586621679152465"><span class="hs-identifier">action</span></a></a><span> </span><a name="local-6989586621679152466"><a href="#local-6989586621679152466"><span class="hs-identifier">cleanup</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-identifier hs-var">MTC.control</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152467"><a href="#local-6989586621679152467"><span class="hs-identifier">runInIO</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152464"><span class="hs-identifier hs-var">ioFinally</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152467"><span class="hs-identifier hs-var">runInIO</span></a><span> </span><a href="#local-6989586621679152465"><span class="hs-identifier hs-var">action</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152467"><span class="hs-identifier hs-var">runInIO</span></a><span> </span><a href="#local-6989586621679152466"><span class="hs-identifier hs-var">cleanup</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">{-|
   Because lifting control operations into 'StateT' is fraught with peril, a
   'MonadOrvilleControl' instance for 'StateT' is provided here and implemented
   via 'MonadBaseControl' rather than together with the 'MonadOrvilleControl'
   definition. We do not recommend using stateful Monad transformer layers in
   Monad stacks based on IO. For anyone that must, this is the canonical
   instance for 'StateT'
  -}</span><span>
</span><a name="line-85"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">MTC.MonadBaseControl</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679152450"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#MonadOrvilleControl"><span class="hs-identifier hs-type">O.MonadOrvilleControl</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679152451"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679152450"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-86"></a><span>  </span><a name="local-8214565720323843865"><a href="Database.Orville.PostgreSQL.Internal.Monad.html#liftWithConnection"><span class="hs-identifier">liftWithConnection</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.MonadBaseControl.html#liftWithConnectionViaBaseControl"><span class="hs-identifier hs-var">liftWithConnectionViaBaseControl</span></a><span>
</span><a name="line-87"></a><span>  </span><a name="local-8214565720323843866"><a href="Database.Orville.PostgreSQL.Internal.Monad.html#liftFinally"><span class="hs-identifier">liftFinally</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.MonadBaseControl.html#liftFinallyViaBaseControl"><span class="hs-identifier hs-var">liftFinallyViaBaseControl</span></a><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span class="hs-comment">{-|
   Because we recommend using 'MonadUnliftIO' rather than 'MonadTransControl',
   we do not provide 'MonadTransControl' instance for 'OrvilleT' by default
   along with the definition. If you do need to use 'MonadTransControl',
   however, this is the canonical instance for 'OrvilleT'.
  -}</span><span>
</span><a name="line-95"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">MTC.MonadTransControl</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleT"><span class="hs-identifier hs-type">O.OrvilleT</span></a><span> </span><a href="#local-6989586621679152448"><span class="hs-identifier hs-type">conn</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-96"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">StT</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleT"><span class="hs-identifier hs-type">O.OrvilleT</span></a><span> </span><a href="#local-6989586621679152448"><span class="hs-identifier hs-type">conn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152449"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">MTC.StT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleEnv"><span class="hs-identifier hs-type">O.OrvilleEnv</span></a><span> </span><a href="#local-6989586621679152448"><span class="hs-identifier hs-type">conn</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152449"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-97"></a><span>  </span><a name="local-8214565720323842404"><span class="hs-identifier">liftWith</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-identifier hs-var">MTC.defaultLiftWith</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleT"><span class="hs-identifier hs-var">InternalMonad.OrvilleT</span></a><span> </span><span class="hs-identifier">InternalMonad.unOrvilleT</span><span>
</span><a name="line-99"></a><span>  </span><a name="local-8214565720323842405"><span class="hs-identifier">restoreT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MTC.defaultRestoreT</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleT"><span class="hs-identifier hs-var">InternalMonad.OrvilleT</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">{-|
   Because we recommend using 'MonadUnliftIO' rather than 'MonadBaseControl',
   we do not provide 'MonadBaseControl' instance for 'OrvilleT' by default
   along with the definition. If you do need to use 'MonadBaseControl',
   however, this is the canonical instance for 'OrvilleT'.
  -}</span><span>
</span><a name="line-107"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">MTC.MonadBaseControl</span><span> </span><a href="#local-6989586621679152444"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-108"></a><span>         </span><span class="hs-identifier hs-type">MTC.MonadBaseControl</span><span> </span><a href="#local-6989586621679152444"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleT"><span class="hs-identifier hs-type">O.OrvilleT</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">StM</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleT"><span class="hs-identifier hs-type">O.OrvilleT</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152447"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">MTC.ComposeSt</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleT"><span class="hs-identifier hs-type">O.OrvilleT</span></a><span> </span><a href="#local-6989586621679152446"><span class="hs-identifier hs-type">conn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152445"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679152447"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-110"></a><span>  </span><a name="local-8214565720323842400"><span class="hs-identifier">liftBaseWith</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MTC.defaultLiftBaseWith</span><span>
</span><a name="line-111"></a><span>  </span><a name="local-8214565720323842401"><span class="hs-identifier">restoreM</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MTC.defaultRestoreM</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">MTC.MonadTransControl</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Trigger.html#OrvilleTriggerT"><span class="hs-identifier hs-type">OT.OrvilleTriggerT</span></a><span> </span><a href="#local-6989586621679152438"><span class="hs-identifier hs-type">trigger</span></a><span> </span><a href="#local-6989586621679152439"><span class="hs-identifier hs-type">conn</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">StT</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Trigger.html#OrvilleTriggerT"><span class="hs-identifier hs-type">OT.OrvilleTriggerT</span></a><span> </span><a href="#local-6989586621679152438"><span class="hs-identifier hs-type">trigger</span></a><span> </span><a href="#local-6989586621679152439"><span class="hs-identifier hs-type">conn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152443"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">MTC.StT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Trigger.html#RecordedTriggersRef"><span class="hs-identifier hs-type">InternalTrigger.RecordedTriggersRef</span></a><span> </span><a href="#local-6989586621679152438"><span class="hs-identifier hs-type">trigger</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MTC.StT</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Monad.html#OrvilleT"><span class="hs-identifier hs-type">O.OrvilleT</span></a><span> </span><a href="#local-6989586621679152439"><span class="hs-identifier hs-type">conn</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152443"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>  </span><a name="local-8214565720323842404"><span class="hs-identifier">liftWith</span></a><span> </span><a name="local-6989586621679152440"><a href="#local-6989586621679152440"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-116"></a><span>    </span><a href="Database.Orville.PostgreSQL.Internal.Trigger.html#OrvilleTriggerT"><span class="hs-identifier hs-var">InternalTrigger.OrvilleTriggerT</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-117"></a><span>    </span><span class="hs-identifier hs-var">MTC.liftWith</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152441"><a href="#local-6989586621679152441"><span class="hs-identifier">runReader</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-118"></a><span>      </span><span class="hs-identifier hs-var">MTC.liftWith</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679152442"><a href="#local-6989586621679152442"><span class="hs-identifier">runOrville</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-119"></a><span>        </span><a href="#local-6989586621679152440"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152442"><span class="hs-identifier hs-var">runOrville</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679152441"><span class="hs-identifier hs-var">runReader</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">InternalTrigger.unTriggerT</span><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>  </span><a name="local-8214565720323842405"><span class="hs-identifier">restoreT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Orville.PostgreSQL.Internal.Trigger.html#OrvilleTriggerT"><span class="hs-identifier hs-var">InternalTrigger.OrvilleTriggerT</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">MTC.restoreT</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">MTC.restoreT</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">MTC.MonadBaseControl</span><span> </span><a href="#local-6989586621679152433"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679152434"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-123"></a><span>         </span><span class="hs-identifier hs-type">MTC.MonadBaseControl</span><span> </span><a href="#local-6989586621679152433"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Trigger.html#OrvilleTriggerT"><span class="hs-identifier hs-type">OT.OrvilleTriggerT</span></a><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-type">trigger</span></a><span> </span><a href="#local-6989586621679152436"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679152434"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-124"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">StM</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Trigger.html#OrvilleTriggerT"><span class="hs-identifier hs-type">OT.OrvilleTriggerT</span></a><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-type">trigger</span></a><span> </span><a href="#local-6989586621679152436"><span class="hs-identifier hs-type">conn</span></a><span> </span><a href="#local-6989586621679152434"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152437"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">MTC.StM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><span class="hs-special">(</span><a href="Database.Orville.PostgreSQL.Internal.Trigger.html#RecordedTriggersRef"><span class="hs-identifier hs-type">InternalTrigger.RecordedTriggersRef</span></a><span> </span><a href="#local-6989586621679152435"><span class="hs-identifier hs-type">trigger</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152434"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152437"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-125"></a><span>  </span><a name="local-8214565720323842400"><span class="hs-identifier">liftBaseWith</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MTC.defaultLiftBaseWith</span><span>
</span><a name="line-126"></a><span>  </span><a name="local-8214565720323842401"><span class="hs-identifier">restoreM</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MTC.defaultRestoreM</span><span>
</span><a name="line-127"></a></pre></body></html>
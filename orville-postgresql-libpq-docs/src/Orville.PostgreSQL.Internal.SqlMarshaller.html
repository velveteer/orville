<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">{- |
Module    : Orville.PostgreSQL.Internal.SqlMarshaller
Copyright : Flipstone Technology Partners 2016-2021
License   : MIT
-}</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Orville.PostgreSQL.Internal.SqlMarshaller</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier">SqlMarshaller</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier">AnnotatedSqlMarshaller</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#annotateSqlMarshaller"><span class="hs-identifier">annotateSqlMarshaller</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#annotateSqlMarshallerEmptyAnnotation"><span class="hs-identifier">annotateSqlMarshallerEmptyAnnotation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#unannotatedSqlMarshaller"><span class="hs-identifier">unannotatedSqlMarshaller</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mapSqlMarshaller"><span class="hs-identifier">mapSqlMarshaller</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallerField"><span class="hs-identifier">MarshallerField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Natural"><span class="hs-identifier">Natural</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Synthetic"><span class="hs-identifier">Synthetic</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallResultFromSql"><span class="hs-identifier">marshallResultFromSql</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallResultFromSqlUsingRowIdExtractor"><span class="hs-identifier">marshallResultFromSqlUsingRowIdExtractor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowIdentityExtractor"><span class="hs-identifier">RowIdentityExtractor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkRowIdentityExtractor"><span class="hs-identifier">mkRowIdentityExtractor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallField"><span class="hs-identifier">marshallField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallSyntheticField"><span class="hs-identifier">marshallSyntheticField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallReadOnlyField"><span class="hs-identifier">marshallReadOnlyField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallReadOnly"><span class="hs-identifier">marshallReadOnly</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallNested"><span class="hs-identifier">marshallNested</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallMaybe"><span class="hs-identifier">marshallMaybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallPartial"><span class="hs-identifier">marshallPartial</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#prefixMarshaller"><span class="hs-identifier">prefixMarshaller</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#ReadOnlyColumnOption"><span class="hs-identifier">ReadOnlyColumnOption</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#IncludeReadOnlyColumns"><span class="hs-identifier">IncludeReadOnlyColumns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#ExcludeReadOnlyColumns"><span class="hs-identifier">ExcludeReadOnlyColumns</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#collectFromField"><span class="hs-identifier">collectFromField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallEntityToSetClauses"><span class="hs-identifier">marshallEntityToSetClauses</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFields"><span class="hs-identifier">foldMarshallerFields</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallerDerivedColumns"><span class="hs-identifier">marshallerDerivedColumns</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkRowSource"><span class="hs-identifier">mkRowSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier">RowSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mapRowSource"><span class="hs-identifier">mapRowSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#applyRowSource"><span class="hs-identifier">applyRowSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#constRowSource"><span class="hs-identifier">constRowSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#failRowSource"><span class="hs-identifier">failRowSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">where</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">join</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B8</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ErrorDetailLevel.html"><span class="hs-identifier">Orville.PostgreSQL.Internal.ErrorDetailLevel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.ErrorDetailLevel.html#ErrorDetailLevel"><span class="hs-identifier">ErrorDetailLevel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html"><span class="hs-identifier">Orville.PostgreSQL.Internal.ExecutionResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Column"><span class="hs-identifier">Column</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Column"><span class="hs-identifier">Column</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#ExecutionResult"><span class="hs-identifier">ExecutionResult</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Row"><span class="hs-identifier">Row</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Row"><span class="hs-identifier">Row</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html"><span class="hs-identifier">Orville.PostgreSQL.Internal.ExecutionResult</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Result</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.Expr.html"><span class="hs-identifier">Orville.PostgreSQL.Internal.Expr</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Expr</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html"><span class="hs-identifier">Orville.PostgreSQL.Internal.FieldDefinition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldDefinition"><span class="hs-identifier">FieldDefinition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldName"><span class="hs-identifier">FieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldNullability"><span class="hs-identifier">FieldNullability</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#NotNullField"><span class="hs-identifier">NotNullField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#NullableField"><span class="hs-identifier">NullableField</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#asymmetricNullableField"><span class="hs-identifier">asymmetricNullableField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldColumnName"><span class="hs-identifier">fieldColumnName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldName"><span class="hs-identifier">fieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldNameToByteString"><span class="hs-identifier">fieldNameToByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldNameToColumnName"><span class="hs-identifier">fieldNameToColumnName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldNullability"><span class="hs-identifier">fieldNullability</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldValueFromSqlValue"><span class="hs-identifier">fieldValueFromSqlValue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#nullableField"><span class="hs-identifier">nullableField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#prefixField"><span class="hs-identifier">prefixField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#setField"><span class="hs-identifier">setField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.MarshallError.html"><span class="hs-identifier">Orville.PostgreSQL.Internal.MarshallError</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MarshallError</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlValue.html"><span class="hs-identifier">Orville.PostgreSQL.Internal.SqlValue</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SqlValue</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SyntheticField.html"><span class="hs-identifier">Orville.PostgreSQL.Internal.SyntheticField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SyntheticField.html#SyntheticField"><span class="hs-identifier">SyntheticField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SyntheticField.html#nullableSyntheticField"><span class="hs-identifier">nullableSyntheticField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SyntheticField.html#prefixSyntheticField"><span class="hs-identifier">prefixSyntheticField</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SyntheticField.html#syntheticFieldAlias"><span class="hs-identifier">syntheticFieldAlias</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SyntheticField.html#syntheticFieldExpression"><span class="hs-identifier">syntheticFieldExpression</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SyntheticField.html#syntheticFieldValueFromSqlValue"><span class="hs-identifier">syntheticFieldValueFromSqlValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">{- |
  An 'AnnotatedSqlMarshaller' is a 'SqlMarshaller' that contains extra
  annotations cannot necessarily be determined from the data in the marshaller
  itself. In particular, it includes the names of fields that be used to
  identify a row in the database when an error is encoutered during decoding.

  Normally you will not need to interact with this type directly -- the
  @TableDefinition@ type creates it for you using the information it has about
  the primary key of table to identify rows in decoding errors. If you are
  executing custom queries directly, you may need to annotate a raw
  'SqlMarshaller' yourself so that rows can be identified. See
  'annotateSqlMarshaller' and 'annotateSqlMarshallerEmptyAnnotation'.
-}</span><span>
</span><span id="line-71"></span><span class="hs-keyword">data</span><span> </span><span id="AnnotatedSqlMarshaller"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier hs-var">AnnotatedSqlMarshaller</span></a></span></span><span> </span><span id="local-6989586621679119878"><span class="annot"><a href="#local-6989586621679119878"><span class="hs-identifier hs-type">writeEntity</span></a></span></span><span> </span><span id="local-6989586621679119877"><span class="annot"><a href="#local-6989586621679119877"><span class="hs-identifier hs-type">readEntity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AnnotatedSqlMarshaller"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier hs-var">AnnotatedSqlMarshaller</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="rowIdFieldNames"><span class="annot"><span class="annottext">AnnotatedSqlMarshaller writeEntity readEntity -&gt; [FieldName]
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#rowIdFieldNames"><span class="hs-identifier hs-var hs-var">rowIdFieldNames</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="unannotatedSqlMarshaller"><span class="annot"><span class="annottext">AnnotatedSqlMarshaller writeEntity readEntity
-&gt; SqlMarshaller writeEntity readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#unannotatedSqlMarshaller"><span class="hs-identifier hs-var hs-var">unannotatedSqlMarshaller</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119878"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119877"><span class="hs-identifier hs-type">readEntity</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">{- |
  Creates an 'AnnotatedSqlMarshaller' that will use the given column names
  to identify rows in error messages when decoding fails. Any column names
  in the list that are not present in the result set will simply be omitted
  from the error message.
-}</span><span>
</span><span id="line-82"></span><span id="local-6989586621679119522"><span id="local-6989586621679119523"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#annotateSqlMarshaller"><span class="hs-identifier hs-type">annotateSqlMarshaller</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119523"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119522"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier hs-type">AnnotatedSqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119523"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119522"><span class="hs-identifier hs-type">readEntity</span></a></span></span></span><span>
</span><span id="line-86"></span><span id="annotateSqlMarshaller"><span class="annot"><span class="annottext">annotateSqlMarshaller :: [FieldName]
-&gt; SqlMarshaller writeEntity readEntity
-&gt; AnnotatedSqlMarshaller writeEntity readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#annotateSqlMarshaller"><span class="hs-identifier hs-var hs-var">annotateSqlMarshaller</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">[FieldName]
-&gt; SqlMarshaller writeEntity readEntity
-&gt; AnnotatedSqlMarshaller writeEntity readEntity
forall writeEntity readEntity.
[FieldName]
-&gt; SqlMarshaller writeEntity readEntity
-&gt; AnnotatedSqlMarshaller writeEntity readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier hs-var">AnnotatedSqlMarshaller</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">{- |
  Creates an 'AnnotatedSqlMarshaller' that will identify rows in decoding
  errors by any columns. This is the equivalent of @annotateSqlMarshaller []@.
-}</span><span>
</span><span id="line-93"></span><span id="local-6989586621679119520"><span id="local-6989586621679119521"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#annotateSqlMarshallerEmptyAnnotation"><span class="hs-identifier hs-type">annotateSqlMarshallerEmptyAnnotation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119521"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119520"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier hs-type">AnnotatedSqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119521"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119520"><span class="hs-identifier hs-type">readEntity</span></a></span></span></span><span>
</span><span id="line-96"></span><span id="annotateSqlMarshallerEmptyAnnotation"><span class="annot"><span class="annottext">annotateSqlMarshallerEmptyAnnotation :: SqlMarshaller writeEntity readEntity
-&gt; AnnotatedSqlMarshaller writeEntity readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#annotateSqlMarshallerEmptyAnnotation"><span class="hs-identifier hs-var hs-var">annotateSqlMarshallerEmptyAnnotation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="annottext">[FieldName]
-&gt; SqlMarshaller writeEntity readEntity
-&gt; AnnotatedSqlMarshaller writeEntity readEntity
forall writeEntity readEntity.
[FieldName]
-&gt; SqlMarshaller writeEntity readEntity
-&gt; AnnotatedSqlMarshaller writeEntity readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#annotateSqlMarshaller"><span class="hs-identifier hs-var">annotateSqlMarshaller</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">{- |
  Applies the provided function to a 'SqlMarshaller' that has been annotated,
  preserving the annotations.
-}</span><span>
</span><span id="line-103"></span><span id="local-6989586621679119516"><span id="local-6989586621679119517"><span id="local-6989586621679119518"><span id="local-6989586621679119519"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mapSqlMarshaller"><span class="hs-identifier hs-type">mapSqlMarshaller</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119519"><span class="hs-identifier hs-type">readEntityA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119518"><span class="hs-identifier hs-type">writeEntityA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119517"><span class="hs-identifier hs-type">readEntityB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119516"><span class="hs-identifier hs-type">writeEntityB</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier hs-type">AnnotatedSqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119519"><span class="hs-identifier hs-type">readEntityA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119518"><span class="hs-identifier hs-type">writeEntityA</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier hs-type">AnnotatedSqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119517"><span class="hs-identifier hs-type">readEntityB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119516"><span class="hs-identifier hs-type">writeEntityB</span></a></span></span></span></span></span><span>
</span><span id="line-107"></span><span id="mapSqlMarshaller"><span class="annot"><span class="annottext">mapSqlMarshaller :: (SqlMarshaller readEntityA writeEntityA
 -&gt; SqlMarshaller readEntityB writeEntityB)
-&gt; AnnotatedSqlMarshaller readEntityA writeEntityA
-&gt; AnnotatedSqlMarshaller readEntityB writeEntityB
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mapSqlMarshaller"><span class="hs-identifier hs-var hs-var">mapSqlMarshaller</span></a></span></span><span> </span><span id="local-6989586621679119515"><span class="annot"><span class="annottext">SqlMarshaller readEntityA writeEntityA
-&gt; SqlMarshaller readEntityB writeEntityB
</span><a href="#local-6989586621679119515"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier hs-type">AnnotatedSqlMarshaller</span></a></span><span> </span><span id="local-6989586621679119514"><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621679119514"><span class="hs-identifier hs-var">rowIdFields</span></a></span></span><span> </span><span id="local-6989586621679119513"><span class="annot"><span class="annottext">SqlMarshaller readEntityA writeEntityA
</span><a href="#local-6989586621679119513"><span class="hs-identifier hs-var">marshaller</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="annottext">[FieldName]
-&gt; SqlMarshaller readEntityB writeEntityB
-&gt; AnnotatedSqlMarshaller readEntityB writeEntityB
forall writeEntity readEntity.
[FieldName]
-&gt; SqlMarshaller writeEntity readEntity
-&gt; AnnotatedSqlMarshaller writeEntity readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier hs-var">AnnotatedSqlMarshaller</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621679119514"><span class="hs-identifier hs-var">rowIdFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SqlMarshaller readEntityA writeEntityA
-&gt; SqlMarshaller readEntityB writeEntityB
</span><a href="#local-6989586621679119515"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller readEntityA writeEntityA
</span><a href="#local-6989586621679119513"><span class="hs-identifier hs-var">marshaller</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">{- |
  'SqlMarshaller' is how we group the lowest level translation of single fields
  into a higher level marshalling of full sql records into Haskell records.
  This is a flexible abstraction that allows us to ultimately model SQL tables
  and work with them as potentially nested Haskell records. We can then
  &quot;marshall&quot; the data as we want to model it in sql and Haskell.
-}</span><span>
</span><span id="line-117"></span><span class="hs-keyword">data</span><span> </span><span id="SqlMarshaller"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-var">SqlMarshaller</span></a></span></span><span> </span><span id="local-6989586621679119512"><span class="annot"><a href="#local-6989586621679119512"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679119511"><span class="annot"><a href="#local-6989586621679119511"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">-- | Our representation of 'pure' in the 'Applicative' sense</span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679119855"><span id="local-6989586621679119856"><span id="MarshallPure"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPure"><span class="hs-identifier hs-var">MarshallPure</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679119856"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119855"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119856"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-comment">-- | Representation of application like '&lt;*&gt;' from 'Applicative'</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679119509"><span id="local-6989586621679119857"><span id="local-6989586621679119859"><span id="MarshallApply"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallApply"><span class="hs-identifier hs-var">MarshallApply</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119509"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119857"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119509"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119859"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119857"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-comment">-- | Nest an arbitrary function, this is used when modeling a SQL table as nested Haskell records</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679119507"><span id="local-6989586621679119640"><span id="local-6989586621679119642"><span id="MarshallNest"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallNest"><span class="hs-identifier hs-var">MarshallNest</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119642"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119507"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119507"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119640"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119642"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119640"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-comment">-- | Marshall a SQL column using the given 'FieldDefinition'</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679119505"><span id="local-6989586621679119638"><span id="MarshallField"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallField"><span class="hs-identifier hs-var">MarshallField</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119505"><span class="hs-identifier hs-type">nullability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119638"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-comment">-- | Marshall a SQL expression on selecting using the given 'SyntheticField'</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-comment">-- to generate selects. SyntheticFields are implicitly read-only, as they</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-comment">-- do not represent a column that can be inserted in to.</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679119634"><span id="local-6989586621679119635"><span id="MarshallSyntheticField"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallSyntheticField"><span class="hs-identifier hs-var">MarshallSyntheticField</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SyntheticField.html#SyntheticField"><span class="hs-identifier hs-type">SyntheticField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119635"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119634"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119635"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-comment">-- | Tag a maybe-mapped marshaller so we don't map it twice</span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679119501"><span id="local-6989586621679119502"><span id="MarshallMaybeTag"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallMaybeTag"><span class="hs-identifier hs-var">MarshallMaybeTag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679119502"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679119501"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679119502"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679119501"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-comment">-- | Marshall a column with a possibility of error</span><span>
</span><span id="line-133"></span><span>  </span><span id="local-6989586621679119603"><span id="local-6989586621679119604"><span id="MarshallPartial"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPartial"><span class="hs-identifier hs-var">MarshallPartial</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119604"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679119603"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119604"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119603"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-comment">-- | Marshall a column that is read only, like auto-incrementing ids</span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679119498"><span id="local-6989586621679119597"><span id="local-6989586621679119598"><span id="MarshallReadOnly"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallReadOnly"><span class="hs-identifier hs-var">MarshallReadOnly</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119498"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119598"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119597"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119598"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679119496"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119493"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119496"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679119491"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; SqlMarshaller a a -&gt; SqlMarshaller a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span id="local-6989586621679119490"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679119490"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679119489"><span class="annot"><span class="annottext">SqlMarshaller a a
</span><a href="#local-6989586621679119489"><span class="hs-identifier hs-var">marsh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (a -&gt; b) -&gt; SqlMarshaller a a -&gt; SqlMarshaller a b
forall a b c.
SqlMarshaller a (b -&gt; c) -&gt; SqlMarshaller a b -&gt; SqlMarshaller a c
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallApply"><span class="hs-identifier hs-var">MarshallApply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; SqlMarshaller a (a -&gt; b)
forall b a. b -&gt; SqlMarshaller a b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPure"><span class="hs-identifier hs-var">MarshallPure</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679119490"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a a
</span><a href="#local-6989586621679119489"><span class="hs-identifier hs-var">marsh</span></a></span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621679119488"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119479"><span id="local-6989586621679119481"><span id="local-6989586621679119483"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119488"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679119477"><span class="annot"><span class="annottext">pure :: a -&gt; SqlMarshaller a a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; SqlMarshaller a a
forall b a. b -&gt; SqlMarshaller a b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPure"><span class="hs-identifier hs-var">MarshallPure</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679119476"><span class="annot"><span class="annottext">&lt;*&gt; :: SqlMarshaller a (a -&gt; b) -&gt; SqlMarshaller a a -&gt; SqlMarshaller a b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (a -&gt; b) -&gt; SqlMarshaller a a -&gt; SqlMarshaller a b
forall a b c.
SqlMarshaller a (b -&gt; c) -&gt; SqlMarshaller a b -&gt; SqlMarshaller a c
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallApply"><span class="hs-identifier hs-var">MarshallApply</span></a></span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">{- |
  Returns a list of 'Expr.DerivedColumn' expressions that can be used in a
  select statement to select values from the database for the 'SqlMarshaller'
  decode.
-}</span><span>
</span><span id="line-149"></span><span id="local-6989586621679119474"><span id="local-6989586621679119475"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallerDerivedColumns"><span class="hs-identifier hs-type">marshallerDerivedColumns</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119475"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119474"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Internal.Expr.Query.SelectList.html#DerivedColumn"><span class="hs-identifier hs-type">Expr.DerivedColumn</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-152"></span><span id="marshallerDerivedColumns"><span class="annot"><span class="annottext">marshallerDerivedColumns :: SqlMarshaller writeEntity readEntity -&gt; [DerivedColumn]
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallerDerivedColumns"><span class="hs-identifier hs-var hs-var">marshallerDerivedColumns</span></a></span></span><span> </span><span id="local-6989586621679119473"><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119473"><span class="hs-identifier hs-var">marshaller</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119807"><span class="annot"><a href="#local-6989586621679119472"><span class="hs-identifier hs-type">collectDerivedColumn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallerField"><span class="hs-identifier hs-type">MarshallerField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119807"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Internal.Expr.Query.SelectList.html#DerivedColumn"><span class="hs-identifier hs-type">Expr.DerivedColumn</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Internal.Expr.Query.SelectList.html#DerivedColumn"><span class="hs-identifier hs-type">Expr.DerivedColumn</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-157"></span><span>      </span><span id="local-6989586621679119472"><span class="annot"><span class="annottext">collectDerivedColumn :: MarshallerField writeEntity -&gt; [DerivedColumn] -&gt; [DerivedColumn]
</span><a href="#local-6989586621679119472"><span class="hs-identifier hs-var hs-var">collectDerivedColumn</span></a></span></span><span> </span><span id="local-6989586621679119471"><span class="annot"><span class="annottext">MarshallerField writeEntity
</span><a href="#local-6989586621679119471"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679119470"><span class="annot"><span class="annottext">[DerivedColumn]
</span><a href="#local-6989586621679119470"><span class="hs-identifier hs-var">columns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MarshallerField writeEntity
</span><a href="#local-6989586621679119471"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-159"></span><span>          </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span id="local-6989586621679119469"><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119469"><span class="hs-identifier hs-var">fieldDef</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (writeEntity -&gt; a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-160"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ValueExpression -&gt; DerivedColumn
</span><a href="Orville.PostgreSQL.Internal.Expr.Query.SelectList.html#deriveColumn"><span class="hs-identifier hs-var">Expr.deriveColumn</span></a></span><span> </span><span class="annot"><span class="annottext">(ValueExpression -&gt; DerivedColumn)
-&gt; (FieldDefinition nullability a -&gt; ValueExpression)
-&gt; FieldDefinition nullability a
-&gt; DerivedColumn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ColumnName -&gt; ValueExpression
</span><a href="Orville.PostgreSQL.Internal.Expr.ValueExpression.html#columnReference"><span class="hs-identifier hs-var">Expr.columnReference</span></a></span><span> </span><span class="annot"><span class="annottext">(ColumnName -&gt; ValueExpression)
-&gt; (FieldDefinition nullability a -&gt; ColumnName)
-&gt; FieldDefinition nullability a
-&gt; ValueExpression
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a -&gt; ColumnName
forall nullability a. FieldDefinition nullability a -&gt; ColumnName
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldColumnName"><span class="hs-identifier hs-var">fieldColumnName</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldDefinition nullability a -&gt; DerivedColumn)
-&gt; FieldDefinition nullability a -&gt; DerivedColumn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119469"><span class="hs-identifier hs-var">fieldDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivedColumn -&gt; [DerivedColumn] -&gt; [DerivedColumn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-161"></span><span>            </span><span class="annot"><span class="annottext">[DerivedColumn]
</span><a href="#local-6989586621679119470"><span class="hs-identifier hs-var">columns</span></a></span><span>
</span><span id="line-162"></span><span>          </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Synthetic"><span class="hs-identifier hs-type">Synthetic</span></a></span><span> </span><span id="local-6989586621679119465"><span class="annot"><span class="annottext">SyntheticField a
</span><a href="#local-6989586621679119465"><span class="hs-identifier hs-var">synthField</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-163"></span><span>            </span><span class="annot"><span class="annottext">ValueExpression -&gt; ColumnName -&gt; DerivedColumn
</span><a href="Orville.PostgreSQL.Internal.Expr.Query.SelectList.html#deriveColumnAs"><span class="hs-identifier hs-var">Expr.deriveColumnAs</span></a></span><span>
</span><span id="line-164"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntheticField a -&gt; ValueExpression
forall a. SyntheticField a -&gt; ValueExpression
</span><a href="Orville.PostgreSQL.Internal.SyntheticField.html#syntheticFieldExpression"><span class="hs-identifier hs-var">syntheticFieldExpression</span></a></span><span> </span><span class="annot"><span class="annottext">SyntheticField a
</span><a href="#local-6989586621679119465"><span class="hs-identifier hs-var">synthField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; ColumnName
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldNameToColumnName"><span class="hs-identifier hs-var">fieldNameToColumnName</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; ColumnName) -&gt; FieldName -&gt; ColumnName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SyntheticField a -&gt; FieldName
forall a. SyntheticField a -&gt; FieldName
</span><a href="Orville.PostgreSQL.Internal.SyntheticField.html#syntheticFieldAlias"><span class="hs-identifier hs-var">syntheticFieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">SyntheticField a
</span><a href="#local-6989586621679119465"><span class="hs-identifier hs-var">synthField</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivedColumn -&gt; [DerivedColumn] -&gt; [DerivedColumn]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-166"></span><span>            </span><span class="annot"><span class="annottext">[DerivedColumn]
</span><a href="#local-6989586621679119470"><span class="hs-identifier hs-var">columns</span></a></span><span>
</span><span id="line-167"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
-&gt; [DerivedColumn]
-&gt; (MarshallerField writeEntity
    -&gt; [DerivedColumn] -&gt; [DerivedColumn])
-&gt; [DerivedColumn]
forall writeEntity readEntity result.
SqlMarshaller writeEntity readEntity
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFields"><span class="hs-identifier hs-var">foldMarshallerFields</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119473"><span class="hs-identifier hs-var">marshaller</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">MarshallerField writeEntity -&gt; [DerivedColumn] -&gt; [DerivedColumn]
forall writeEntity.
MarshallerField writeEntity -&gt; [DerivedColumn] -&gt; [DerivedColumn]
</span><a href="#local-6989586621679119472"><span class="hs-identifier hs-var">collectDerivedColumn</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">{- |
  Represents a primitive entry in a 'SqlMarshaller'. This type is used with
  'foldMarshallerFields' to provided the entry from the mashaller to the
  folding function to be incorporate in the result of the fold.
-}</span><span>
</span><span id="line-174"></span><span class="hs-keyword">data</span><span> </span><span id="MarshallerField"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallerField"><span class="hs-identifier hs-var">MarshallerField</span></a></span></span><span> </span><span id="local-6989586621679119463"><span class="annot"><a href="#local-6989586621679119463"><span class="hs-identifier hs-type">writeEntity</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>  </span><span id="local-6989586621679119461"><span id="local-6989586621679119462"><span id="local-6989586621679119767"><span id="Natural"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Natural"><span class="hs-identifier hs-var">Natural</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119462"><span class="hs-identifier hs-type">nullability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119767"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallerField"><span class="hs-identifier hs-type">MarshallerField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119767"><span class="hs-identifier hs-type">writeEntity</span></a></span></span></span></span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679119460"><span id="local-6989586621679119765"><span id="Synthetic"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Synthetic"><span class="hs-identifier hs-var">Synthetic</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SyntheticField.html#SyntheticField"><span class="hs-identifier hs-type">SyntheticField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119460"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallerField"><span class="hs-identifier hs-type">MarshallerField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119765"><span class="hs-identifier hs-type">writeEntity</span></a></span></span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">{- |
  A fold function that can be used with 'foldMarshallerFields' to collect
  a value calculated from a 'FieldDefinition' via the given function. The calculated
  value is added to the list of values being built.

  Note: Folds executed with 'collectFromField' ignore 'Synthetic' entries in
  the marshaller. You should only use 'collectFromField' in situations where
  you only care about the actual columns referenced by the marshaller.
-}</span><span>
</span><span id="line-187"></span><span id="local-6989586621679119458"><span id="local-6989586621679119459"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#collectFromField"><span class="hs-identifier hs-type">collectFromField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#ReadOnlyColumnOption"><span class="hs-identifier hs-type">ReadOnlyColumnOption</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679119805"><span class="annot"><a href="#local-6989586621679119805"><span class="hs-identifier hs-type">nullability</span></a></span></span><span> </span><span id="local-6989586621679119804"><span class="annot"><a href="#local-6989586621679119804"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119805"><span class="hs-identifier hs-type">nullability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119804"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119459"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallerField"><span class="hs-identifier hs-type">MarshallerField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119458"><span class="hs-identifier hs-type">entity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679119459"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679119459"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-193"></span><span id="collectFromField"><span class="annot"><span class="annottext">collectFromField :: ReadOnlyColumnOption
-&gt; (forall nullability a. FieldDefinition nullability a -&gt; result)
-&gt; MarshallerField entity
-&gt; [result]
-&gt; [result]
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#collectFromField"><span class="hs-identifier hs-var hs-var">collectFromField</span></a></span></span><span> </span><span id="local-6989586621679119457"><span class="annot"><span class="annottext">ReadOnlyColumnOption
</span><a href="#local-6989586621679119457"><span class="hs-identifier hs-var">readOnlyColumnOption</span></a></span></span><span> </span><span id="local-6989586621679119456"><span class="annot"><span class="annottext">forall nullability a. FieldDefinition nullability a -&gt; result
</span><a href="#local-6989586621679119456"><span class="hs-identifier hs-var">fromField</span></a></span></span><span> </span><span id="local-6989586621679119455"><span class="annot"><span class="annottext">MarshallerField entity
</span><a href="#local-6989586621679119455"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679119454"><span class="annot"><span class="annottext">[result]
</span><a href="#local-6989586621679119454"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MarshallerField entity
</span><a href="#local-6989586621679119455"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span id="local-6989586621679119453"><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119453"><span class="hs-identifier hs-var">fieldDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">entity -&gt; a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-196"></span><span>      </span><span class="annot"><span class="annottext">FieldDefinition nullability a -&gt; result
forall nullability a. FieldDefinition nullability a -&gt; result
</span><a href="#local-6989586621679119456"><span class="hs-identifier hs-var">fromField</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119453"><span class="hs-identifier hs-var">fieldDef</span></a></span><span> </span><span class="annot"><span class="annottext">result -&gt; [result] -&gt; [result]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[result]
</span><a href="#local-6989586621679119454"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span id="local-6989586621679119452"><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119452"><span class="hs-identifier hs-var">fieldDef</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (entity -&gt; a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadOnlyColumnOption
</span><a href="#local-6989586621679119457"><span class="hs-identifier hs-var">readOnlyColumnOption</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">ReadOnlyColumnOption
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#IncludeReadOnlyColumns"><span class="hs-identifier hs-var">IncludeReadOnlyColumns</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a -&gt; result
forall nullability a. FieldDefinition nullability a -&gt; result
</span><a href="#local-6989586621679119456"><span class="hs-identifier hs-var">fromField</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119452"><span class="hs-identifier hs-var">fieldDef</span></a></span><span> </span><span class="annot"><span class="annottext">result -&gt; [result] -&gt; [result]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[result]
</span><a href="#local-6989586621679119454"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><span class="annottext">ReadOnlyColumnOption
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#ExcludeReadOnlyColumns"><span class="hs-identifier hs-var">ExcludeReadOnlyColumns</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[result]
</span><a href="#local-6989586621679119454"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Synthetic"><span class="hs-identifier hs-type">Synthetic</span></a></span><span> </span><span class="annot"><span class="annottext">SyntheticField a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>      </span><span class="annot"><span class="annottext">[result]
</span><a href="#local-6989586621679119454"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">{- |
  Uses the field defintions in the marshaller to construct SQL expressions
  that will set columns of the field defintions to their corresponding value
  found in the Haskell @writeEntity@  value.
-}</span><span>
</span><span id="line-209"></span><span id="local-6989586621679119450"><span id="local-6989586621679119451"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallEntityToSetClauses"><span class="hs-identifier hs-type">marshallEntityToSetClauses</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119451"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119450"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="#local-6989586621679119451"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Internal.Expr.Update.SetClause.html#SetClause"><span class="hs-identifier hs-type">Expr.SetClause</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-213"></span><span id="marshallEntityToSetClauses"><span class="annot"><span class="annottext">marshallEntityToSetClauses :: SqlMarshaller writeEntity readEntity -&gt; writeEntity -&gt; [SetClause]
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallEntityToSetClauses"><span class="hs-identifier hs-var hs-var">marshallEntityToSetClauses</span></a></span></span><span> </span><span id="local-6989586621679119449"><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119449"><span class="hs-identifier hs-var">marshaller</span></a></span></span><span> </span><span id="local-6989586621679119448"><span class="annot"><span class="annottext">writeEntity
</span><a href="#local-6989586621679119448"><span class="hs-identifier hs-var">writeEntity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
-&gt; [SetClause]
-&gt; (MarshallerField writeEntity -&gt; [SetClause] -&gt; [SetClause])
-&gt; [SetClause]
forall writeEntity readEntity result.
SqlMarshaller writeEntity readEntity
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFields"><span class="hs-identifier hs-var">foldMarshallerFields</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119449"><span class="hs-identifier hs-var">marshaller</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">writeEntity
-&gt; MarshallerField writeEntity -&gt; [SetClause] -&gt; [SetClause]
forall entity.
entity -&gt; MarshallerField entity -&gt; [SetClause] -&gt; [SetClause]
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#collectSetClauses"><span class="hs-identifier hs-var">collectSetClauses</span></a></span><span> </span><span class="annot"><span class="annottext">writeEntity
</span><a href="#local-6989586621679119448"><span class="hs-identifier hs-var">writeEntity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">{- |
  An internal helper function that collects the 'Expr.SetClause's to
  update all the fields contained in a 'SqlMarshaller'
-}</span><span>
</span><span id="line-223"></span><span id="local-6989586621679119793"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#collectSetClauses"><span class="hs-identifier hs-type">collectSetClauses</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="#local-6989586621679119793"><span class="hs-identifier hs-type">entity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallerField"><span class="hs-identifier hs-type">MarshallerField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119793"><span class="hs-identifier hs-type">entity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Internal.Expr.Update.SetClause.html#SetClause"><span class="hs-identifier hs-type">Expr.SetClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Internal.Expr.Update.SetClause.html#SetClause"><span class="hs-identifier hs-type">Expr.SetClause</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-228"></span><span id="collectSetClauses"><span class="annot"><span class="annottext">collectSetClauses :: entity -&gt; MarshallerField entity -&gt; [SetClause] -&gt; [SetClause]
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#collectSetClauses"><span class="hs-identifier hs-var hs-var">collectSetClauses</span></a></span></span><span> </span><span id="local-6989586621679119446"><span class="annot"><span class="annottext">entity
</span><a href="#local-6989586621679119446"><span class="hs-identifier hs-var">entity</span></a></span></span><span> </span><span id="local-6989586621679119445"><span class="annot"><span class="annottext">MarshallerField entity
</span><a href="#local-6989586621679119445"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679119444"><span class="annot"><span class="annottext">[SetClause]
</span><a href="#local-6989586621679119444"><span class="hs-identifier hs-var">clauses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MarshallerField entity
</span><a href="#local-6989586621679119445"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span id="local-6989586621679119443"><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119443"><span class="hs-identifier hs-var">fieldDef</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679119442"><span class="annot"><span class="annottext">entity -&gt; a
</span><a href="#local-6989586621679119442"><span class="hs-identifier hs-var">accessor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-231"></span><span>      </span><span class="annot"><span class="annottext">FieldDefinition nullability a -&gt; a -&gt; SetClause
forall nullability a.
FieldDefinition nullability a -&gt; a -&gt; SetClause
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#setField"><span class="hs-identifier hs-var">setField</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119443"><span class="hs-identifier hs-var">fieldDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">entity -&gt; a
</span><a href="#local-6989586621679119442"><span class="hs-identifier hs-var">accessor</span></a></span><span> </span><span class="annot"><span class="annottext">entity
</span><a href="#local-6989586621679119446"><span class="hs-identifier hs-var">entity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SetClause -&gt; [SetClause] -&gt; [SetClause]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[SetClause]
</span><a href="#local-6989586621679119444"><span class="hs-identifier hs-var">clauses</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (entity -&gt; a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">[SetClause]
</span><a href="#local-6989586621679119444"><span class="hs-identifier hs-var">clauses</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Synthetic"><span class="hs-identifier hs-type">Synthetic</span></a></span><span> </span><span class="annot"><span class="annottext">SyntheticField a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><span class="annottext">[SetClause]
</span><a href="#local-6989586621679119444"><span class="hs-identifier hs-var">clauses</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">{- |
  Specifies whether read-only fields should be included when using functions
  such as 'collectFromField' and 'marshallerColumnNames'.
-}</span><span>
</span><span id="line-241"></span><span class="hs-keyword">data</span><span> </span><span id="ReadOnlyColumnOption"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#ReadOnlyColumnOption"><span class="hs-identifier hs-var">ReadOnlyColumnOption</span></a></span></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="IncludeReadOnlyColumns"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#IncludeReadOnlyColumns"><span class="hs-identifier hs-var">IncludeReadOnlyColumns</span></a></span></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ExcludeReadOnlyColumns"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#ExcludeReadOnlyColumns"><span class="hs-identifier hs-var">ExcludeReadOnlyColumns</span></a></span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">{- |
  'foldMarshallerFields' allows you to consume the 'FieldDefinition's that
  are contained within the 'SqlMarshaller' to process them however is
  required. This can be used to collect the names of all the fields, encode
  them to 'SqlValue', etc.
-}</span><span>
</span><span id="line-251"></span><span id="local-6989586621679119808"><span id="local-6989586621679119809"><span id="local-6989586621679119810"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFields"><span class="hs-identifier hs-type">foldMarshallerFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119810"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119809"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="#local-6989586621679119808"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallerField"><span class="hs-identifier hs-type">MarshallerField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119810"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119808"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119808"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><a href="#local-6989586621679119808"><span class="hs-identifier hs-type">result</span></a></span></span></span></span><span>
</span><span id="line-256"></span><span id="foldMarshallerFields"><span class="annot"><span class="annottext">foldMarshallerFields :: SqlMarshaller writeEntity readEntity
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFields"><span class="hs-identifier hs-var hs-var">foldMarshallerFields</span></a></span></span><span> </span><span id="local-6989586621679119441"><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119441"><span class="hs-identifier hs-var">marshaller</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
-&gt; Maybe (writeEntity -&gt; writeEntity)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
forall entityPart readEntity writeEntity result.
SqlMarshaller entityPart readEntity
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFieldsPart"><span class="hs-identifier hs-var">foldMarshallerFieldsPart</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119441"><span class="hs-identifier hs-var">marshaller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(writeEntity -&gt; writeEntity) -&gt; Maybe (writeEntity -&gt; writeEntity)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">writeEntity -&gt; writeEntity
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">{- |
  The internal helper function that actually implements 'foldMarshallerFields'.
  It takes with it a function that extracts the current nesting entity from
  the overall 'writeEntity' that the 'SqlMarshaller' is build on. 'MarshallNest'
  adds more nesting by composing its accessor with the one given here.
-}</span><span>
</span><span id="line-265"></span><span id="local-6989586621679119778"><span id="local-6989586621679119779"><span id="local-6989586621679119780"><span id="local-6989586621679119781"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFieldsPart"><span class="hs-identifier hs-type">foldMarshallerFieldsPart</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119781"><span class="hs-identifier hs-type">entityPart</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119780"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119779"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119781"><span class="hs-identifier hs-type">entityPart</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><a href="#local-6989586621679119778"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallerField"><span class="hs-identifier hs-type">MarshallerField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119779"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119778"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119778"><span class="hs-identifier hs-type">result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><a href="#local-6989586621679119778"><span class="hs-identifier hs-type">result</span></a></span></span></span></span></span><span>
</span><span id="line-271"></span><span id="foldMarshallerFieldsPart"><span class="annot"><span class="annottext">foldMarshallerFieldsPart :: SqlMarshaller entityPart readEntity
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFieldsPart"><span class="hs-identifier hs-var hs-var">foldMarshallerFieldsPart</span></a></span></span><span> </span><span id="local-6989586621679119438"><span class="annot"><span class="annottext">SqlMarshaller entityPart readEntity
</span><a href="#local-6989586621679119438"><span class="hs-identifier hs-var">marshaller</span></a></span></span><span> </span><span id="local-6989586621679119437"><span class="annot"><span class="annottext">Maybe (writeEntity -&gt; entityPart)
</span><a href="#local-6989586621679119437"><span class="hs-identifier hs-var">getPart</span></a></span></span><span> </span><span id="local-6989586621679119436"><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119436"><span class="hs-identifier hs-var">currentResult</span></a></span></span><span> </span><span id="local-6989586621679119435"><span class="annot"><span class="annottext">MarshallerField writeEntity -&gt; result -&gt; result
</span><a href="#local-6989586621679119435"><span class="hs-identifier hs-var">addToResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller entityPart readEntity
</span><a href="#local-6989586621679119438"><span class="hs-identifier hs-var">marshaller</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPure"><span class="hs-identifier hs-type">MarshallPure</span></a></span><span> </span><span class="annot"><span class="annottext">readEntity
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119436"><span class="hs-identifier hs-var">currentResult</span></a></span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallApply"><span class="hs-identifier hs-type">MarshallApply</span></a></span><span> </span><span id="local-6989586621679119434"><span class="annot"><span class="annottext">SqlMarshaller entityPart (b -&gt; readEntity)
</span><a href="#local-6989586621679119434"><span class="hs-identifier hs-var">submarshallerA</span></a></span></span><span> </span><span id="local-6989586621679119433"><span class="annot"><span class="annottext">SqlMarshaller entityPart b
</span><a href="#local-6989586621679119433"><span class="hs-identifier hs-var">submarshallerB</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-276"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119432"><span class="annot"><span class="annottext">subresultB :: result
</span><a href="#local-6989586621679119432"><span class="hs-identifier hs-var hs-var">subresultB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>            </span><span class="annot"><span class="annottext">SqlMarshaller entityPart b
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
forall entityPart readEntity writeEntity result.
SqlMarshaller entityPart readEntity
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFieldsPart"><span class="hs-identifier hs-var">foldMarshallerFieldsPart</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller entityPart b
</span><a href="#local-6989586621679119433"><span class="hs-identifier hs-var">submarshallerB</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (writeEntity -&gt; entityPart)
</span><a href="#local-6989586621679119437"><span class="hs-identifier hs-var">getPart</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119436"><span class="hs-identifier hs-var">currentResult</span></a></span><span> </span><span class="annot"><span class="annottext">MarshallerField writeEntity -&gt; result -&gt; result
</span><a href="#local-6989586621679119435"><span class="hs-identifier hs-var">addToResult</span></a></span><span>
</span><span id="line-278"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller entityPart (b -&gt; readEntity)
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
forall entityPart readEntity writeEntity result.
SqlMarshaller entityPart readEntity
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFieldsPart"><span class="hs-identifier hs-var">foldMarshallerFieldsPart</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller entityPart (b -&gt; readEntity)
</span><a href="#local-6989586621679119434"><span class="hs-identifier hs-var">submarshallerA</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (writeEntity -&gt; entityPart)
</span><a href="#local-6989586621679119437"><span class="hs-identifier hs-var">getPart</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119432"><span class="hs-identifier hs-var">subresultB</span></a></span><span> </span><span class="annot"><span class="annottext">MarshallerField writeEntity -&gt; result -&gt; result
</span><a href="#local-6989586621679119435"><span class="hs-identifier hs-var">addToResult</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallNest"><span class="hs-identifier hs-type">MarshallNest</span></a></span><span> </span><span id="local-6989586621679119431"><span class="annot"><span class="annottext">entityPart -&gt; b
</span><a href="#local-6989586621679119431"><span class="hs-identifier hs-var">nestingFunction</span></a></span></span><span> </span><span id="local-6989586621679119430"><span class="annot"><span class="annottext">SqlMarshaller b readEntity
</span><a href="#local-6989586621679119430"><span class="hs-identifier hs-var">submarshaller</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-280"></span><span>      </span><span class="annot"><span class="annottext">SqlMarshaller b readEntity
-&gt; Maybe (writeEntity -&gt; b)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
forall entityPart readEntity writeEntity result.
SqlMarshaller entityPart readEntity
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFieldsPart"><span class="hs-identifier hs-var">foldMarshallerFieldsPart</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller b readEntity
</span><a href="#local-6989586621679119430"><span class="hs-identifier hs-var">submarshaller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((writeEntity -&gt; entityPart) -&gt; writeEntity -&gt; b)
-&gt; Maybe (writeEntity -&gt; entityPart) -&gt; Maybe (writeEntity -&gt; b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">entityPart -&gt; b
</span><a href="#local-6989586621679119431"><span class="hs-identifier hs-var">nestingFunction</span></a></span><span> </span><span class="annot"><span class="annottext">(entityPart -&gt; b)
-&gt; (writeEntity -&gt; entityPart) -&gt; writeEntity -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (writeEntity -&gt; entityPart)
</span><a href="#local-6989586621679119437"><span class="hs-identifier hs-var">getPart</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119436"><span class="hs-identifier hs-var">currentResult</span></a></span><span> </span><span class="annot"><span class="annottext">MarshallerField writeEntity -&gt; result -&gt; result
</span><a href="#local-6989586621679119435"><span class="hs-identifier hs-var">addToResult</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallField"><span class="hs-identifier hs-type">MarshallField</span></a></span><span> </span><span id="local-6989586621679119429"><span class="annot"><span class="annottext">FieldDefinition nullability entityPart
</span><a href="#local-6989586621679119429"><span class="hs-identifier hs-var">fieldDefinition</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="annottext">MarshallerField writeEntity -&gt; result -&gt; result
</span><a href="#local-6989586621679119435"><span class="hs-identifier hs-var">addToResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDefinition nullability entityPart
-&gt; Maybe (writeEntity -&gt; entityPart) -&gt; MarshallerField writeEntity
forall nullability a writeEntity.
FieldDefinition nullability a
-&gt; Maybe (writeEntity -&gt; a) -&gt; MarshallerField writeEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Natural"><span class="hs-identifier hs-var">Natural</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability entityPart
</span><a href="#local-6989586621679119429"><span class="hs-identifier hs-var">fieldDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (writeEntity -&gt; entityPart)
</span><a href="#local-6989586621679119437"><span class="hs-identifier hs-var">getPart</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119436"><span class="hs-identifier hs-var">currentResult</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallSyntheticField"><span class="hs-identifier hs-type">MarshallSyntheticField</span></a></span><span> </span><span id="local-6989586621679119428"><span class="annot"><span class="annottext">SyntheticField readEntity
</span><a href="#local-6989586621679119428"><span class="hs-identifier hs-var">syntheticField</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><span class="annottext">MarshallerField writeEntity -&gt; result -&gt; result
</span><a href="#local-6989586621679119435"><span class="hs-identifier hs-var">addToResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntheticField readEntity -&gt; MarshallerField writeEntity
forall a writeEntity.
SyntheticField a -&gt; MarshallerField writeEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Synthetic"><span class="hs-identifier hs-var">Synthetic</span></a></span><span> </span><span class="annot"><span class="annottext">SyntheticField readEntity
</span><a href="#local-6989586621679119428"><span class="hs-identifier hs-var">syntheticField</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119436"><span class="hs-identifier hs-var">currentResult</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallMaybeTag"><span class="hs-identifier hs-type">MarshallMaybeTag</span></a></span><span> </span><span id="local-6989586621679119427"><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119427"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
-&gt; Maybe (writeEntity -&gt; Maybe a)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
forall entityPart readEntity writeEntity result.
SqlMarshaller entityPart readEntity
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFieldsPart"><span class="hs-identifier hs-var">foldMarshallerFieldsPart</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119427"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (writeEntity -&gt; entityPart)
Maybe (writeEntity -&gt; Maybe a)
</span><a href="#local-6989586621679119437"><span class="hs-identifier hs-var">getPart</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119436"><span class="hs-identifier hs-var">currentResult</span></a></span><span> </span><span class="annot"><span class="annottext">MarshallerField writeEntity -&gt; result -&gt; result
</span><a href="#local-6989586621679119435"><span class="hs-identifier hs-var">addToResult</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPartial"><span class="hs-identifier hs-type">MarshallPartial</span></a></span><span> </span><span id="local-6989586621679119426"><span class="annot"><span class="annottext">SqlMarshaller entityPart (Either String readEntity)
</span><a href="#local-6989586621679119426"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><span class="annottext">SqlMarshaller entityPart (Either String readEntity)
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
forall entityPart readEntity writeEntity result.
SqlMarshaller entityPart readEntity
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFieldsPart"><span class="hs-identifier hs-var">foldMarshallerFieldsPart</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller entityPart (Either String readEntity)
</span><a href="#local-6989586621679119426"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (writeEntity -&gt; entityPart)
</span><a href="#local-6989586621679119437"><span class="hs-identifier hs-var">getPart</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119436"><span class="hs-identifier hs-var">currentResult</span></a></span><span> </span><span class="annot"><span class="annottext">MarshallerField writeEntity -&gt; result -&gt; result
</span><a href="#local-6989586621679119435"><span class="hs-identifier hs-var">addToResult</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallReadOnly"><span class="hs-identifier hs-type">MarshallReadOnly</span></a></span><span> </span><span id="local-6989586621679119425"><span class="annot"><span class="annottext">SqlMarshaller a readEntity
</span><a href="#local-6989586621679119425"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><span class="annottext">SqlMarshaller a readEntity
-&gt; Maybe (writeEntity -&gt; a)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
forall entityPart readEntity writeEntity result.
SqlMarshaller entityPart readEntity
-&gt; Maybe (writeEntity -&gt; entityPart)
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFieldsPart"><span class="hs-identifier hs-var">foldMarshallerFieldsPart</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a readEntity
</span><a href="#local-6989586621679119425"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (writeEntity -&gt; a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119436"><span class="hs-identifier hs-var">currentResult</span></a></span><span> </span><span class="annot"><span class="annottext">MarshallerField writeEntity -&gt; result -&gt; result
</span><a href="#local-6989586621679119435"><span class="hs-identifier hs-var">addToResult</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">{- |
  Decodes all the rows found in a execution result at once. The first row that
  fails to decode will return the 'MarshallErrorDetails' that results, otherwise all
  decoded rows will be returned.

  Note that this function loads are decoded rows into memory at once, so it
  should only be used with result sets that you know will fit into memory.
-}</span><span>
</span><span id="line-300"></span><span id="local-6989586621679119422"><span id="local-6989586621679119423"><span id="local-6989586621679119424"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallResultFromSql"><span class="hs-identifier hs-type">marshallResultFromSql</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#ExecutionResult"><span class="hs-identifier hs-type">ExecutionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119424"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ErrorDetailLevel.html#ErrorDetailLevel"><span class="hs-identifier hs-type">ErrorDetailLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#AnnotatedSqlMarshaller"><span class="hs-identifier hs-type">AnnotatedSqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119423"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119422"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><a href="#local-6989586621679119424"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.MarshallError.html#MarshallError"><span class="hs-identifier hs-type">MarshallError.MarshallError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679119422"><span class="hs-identifier hs-type">readEntity</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-306"></span><span id="marshallResultFromSql"><span class="annot"><span class="annottext">marshallResultFromSql :: ErrorDetailLevel
-&gt; AnnotatedSqlMarshaller writeEntity readEntity
-&gt; result
-&gt; IO (Either MarshallError [readEntity])
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallResultFromSql"><span class="hs-identifier hs-var hs-var">marshallResultFromSql</span></a></span></span><span> </span><span id="local-6989586621679119421"><span class="annot"><span class="annottext">ErrorDetailLevel
</span><a href="#local-6989586621679119421"><span class="hs-identifier hs-var">errorDetailLevel</span></a></span></span><span> </span><span id="local-6989586621679119420"><span class="annot"><span class="annottext">AnnotatedSqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119420"><span class="hs-identifier hs-var">marshallerWithMeta</span></a></span></span><span> </span><span id="local-6989586621679119419"><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119419"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><span class="annottext">ErrorDetailLevel
-&gt; RowIdentityExtractor
-&gt; SqlMarshaller writeEntity readEntity
-&gt; result
-&gt; IO (Either MarshallError [readEntity])
forall result writeEntity readEntity.
ExecutionResult result =&gt;
ErrorDetailLevel
-&gt; RowIdentityExtractor
-&gt; SqlMarshaller writeEntity readEntity
-&gt; result
-&gt; IO (Either MarshallError [readEntity])
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallResultFromSqlUsingRowIdExtractor"><span class="hs-identifier hs-var">marshallResultFromSqlUsingRowIdExtractor</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><span class="annottext">ErrorDetailLevel
</span><a href="#local-6989586621679119421"><span class="hs-identifier hs-var">errorDetailLevel</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FieldName] -&gt; result -&gt; RowIdentityExtractor
forall result.
ExecutionResult result =&gt;
[FieldName] -&gt; result -&gt; RowIdentityExtractor
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkRowIdentityExtractor"><span class="hs-identifier hs-var">mkRowIdentityExtractor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedSqlMarshaller writeEntity readEntity -&gt; [FieldName]
forall writeEntity readEntity.
AnnotatedSqlMarshaller writeEntity readEntity -&gt; [FieldName]
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#rowIdFieldNames"><span class="hs-identifier hs-var hs-var">rowIdFieldNames</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedSqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119420"><span class="hs-identifier hs-var">marshallerWithMeta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119419"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedSqlMarshaller writeEntity readEntity
-&gt; SqlMarshaller writeEntity readEntity
forall writeEntity readEntity.
AnnotatedSqlMarshaller writeEntity readEntity
-&gt; SqlMarshaller writeEntity readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#unannotatedSqlMarshaller"><span class="hs-identifier hs-var hs-var">unannotatedSqlMarshaller</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedSqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119420"><span class="hs-identifier hs-var">marshallerWithMeta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119419"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">{- |
  Decodes all the rows found in a execution result at once. The first row that
  fails to decode will return the 'MarshallErrorDetails' that results, otherwise all
  decoded rows will be returned. If an error occurs while decoding a row, the
  'RowIdentityExtractor' will be used to extract values to identify the row
  in the error details.

  Note that this function loads are decoded rows into memory at once, so it
  should only be used with result sets that you know will fit into memory.
-}</span><span>
</span><span id="line-323"></span><span id="local-6989586621679119751"><span id="local-6989586621679119752"><span id="local-6989586621679119754"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallResultFromSqlUsingRowIdExtractor"><span class="hs-identifier hs-type">marshallResultFromSqlUsingRowIdExtractor</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#ExecutionResult"><span class="hs-identifier hs-type">ExecutionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119754"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ErrorDetailLevel.html#ErrorDetailLevel"><span class="hs-identifier hs-type">ErrorDetailLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowIdentityExtractor"><span class="hs-identifier hs-type">RowIdentityExtractor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119752"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119751"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><a href="#local-6989586621679119754"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.MarshallError.html#MarshallError"><span class="hs-identifier hs-type">MarshallError.MarshallError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679119751"><span class="hs-identifier hs-type">readEntity</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-330"></span><span id="marshallResultFromSqlUsingRowIdExtractor"><span class="annot"><span class="annottext">marshallResultFromSqlUsingRowIdExtractor :: ErrorDetailLevel
-&gt; RowIdentityExtractor
-&gt; SqlMarshaller writeEntity readEntity
-&gt; result
-&gt; IO (Either MarshallError [readEntity])
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallResultFromSqlUsingRowIdExtractor"><span class="hs-identifier hs-var hs-var">marshallResultFromSqlUsingRowIdExtractor</span></a></span></span><span> </span><span id="local-6989586621679119418"><span class="annot"><span class="annottext">ErrorDetailLevel
</span><a href="#local-6989586621679119418"><span class="hs-identifier hs-var">errorDetailLevel</span></a></span></span><span> </span><span id="local-6989586621679119417"><span class="annot"><span class="annottext">RowIdentityExtractor
</span><a href="#local-6989586621679119417"><span class="hs-identifier hs-var">rowIdExtractor</span></a></span></span><span> </span><span id="local-6989586621679119416"><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119416"><span class="hs-identifier hs-var">marshaller</span></a></span></span><span> </span><span id="local-6989586621679119415"><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119415"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621679119414"><span class="annot"><span class="annottext">Maybe Row
</span><a href="#local-6989586621679119414"><span class="hs-identifier hs-var">mbMaxRow</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">result -&gt; IO (Maybe Row)
forall result. ExecutionResult result =&gt; result -&gt; IO (Maybe Row)
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#maxRowNumber"><span class="hs-identifier hs-var">Result.maxRowNumber</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119415"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Row
</span><a href="#local-6989586621679119414"><span class="hs-identifier hs-var">mbMaxRow</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><span class="annottext">Maybe Row
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-335"></span><span>      </span><span class="annot"><span class="annottext">Either MarshallError [readEntity]
-&gt; IO (Either MarshallError [readEntity])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[readEntity] -&gt; Either MarshallError [readEntity]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679119412"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119412"><span class="hs-identifier hs-var">maxRow</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>      </span><span id="local-6989586621679119411"><span class="annot"><span class="annottext">RowSource readEntity
</span><a href="#local-6989586621679119411"><span class="hs-identifier hs-var">rowSource</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
-&gt; result -&gt; IO (RowSource readEntity)
forall result writeEntity readEntity.
ExecutionResult result =&gt;
SqlMarshaller writeEntity readEntity
-&gt; result -&gt; IO (RowSource readEntity)
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkRowSource"><span class="hs-identifier hs-var">mkRowSource</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119416"><span class="hs-identifier hs-var">marshaller</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119415"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-338"></span><span>      </span><span class="annot"><span class="annottext">(Row -&gt; IO (Either MarshallError readEntity))
-&gt; [Row] -&gt; IO (Either MarshallError [readEntity])
forall a err b.
(a -&gt; IO (Either err b)) -&gt; [a] -&gt; IO (Either err [b])
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#traverseSequence"><span class="hs-identifier hs-var">traverseSequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorDetailLevel
-&gt; RowSource readEntity
-&gt; RowIdentityExtractor
-&gt; Row
-&gt; IO (Either MarshallError readEntity)
forall readEntity.
ErrorDetailLevel
-&gt; RowSource readEntity
-&gt; RowIdentityExtractor
-&gt; Row
-&gt; IO (Either MarshallError readEntity)
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#decodeRow"><span class="hs-identifier hs-var">decodeRow</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorDetailLevel
</span><a href="#local-6989586621679119418"><span class="hs-identifier hs-var">errorDetailLevel</span></a></span><span> </span><span class="annot"><span class="annottext">RowSource readEntity
</span><a href="#local-6989586621679119411"><span class="hs-identifier hs-var">rowSource</span></a></span><span> </span><span class="annot"><span class="annottext">RowIdentityExtractor
</span><a href="#local-6989586621679119417"><span class="hs-identifier hs-var">rowIdExtractor</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Row
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Row"><span class="hs-identifier hs-var">Row</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119412"><span class="hs-identifier hs-var">maxRow</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span id="local-6989586621679119736"><span id="local-6989586621679119737"><span id="local-6989586621679119738"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#traverseSequence"><span class="hs-identifier hs-type">traverseSequence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119738"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679119737"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119736"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679119738"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679119737"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679119736"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-341"></span><span id="traverseSequence"><span class="annot"><span class="annottext">traverseSequence :: (a -&gt; IO (Either err b)) -&gt; [a] -&gt; IO (Either err [b])
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#traverseSequence"><span class="hs-identifier hs-var hs-var">traverseSequence</span></a></span></span><span> </span><span id="local-6989586621679119408"><span class="annot"><span class="annottext">a -&gt; IO (Either err b)
</span><a href="#local-6989586621679119408"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; IO (Either err [b])
</span><a href="#local-6989586621679119407"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-344"></span><span>    </span><span id="local-6989586621679119407"><span class="annot"><span class="annottext">go :: [a] -&gt; IO (Either err [b])
</span><a href="#local-6989586621679119407"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679119406"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679119406"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679119406"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-347"></span><span>          </span><span class="annot"><span class="annottext">Either err [b] -&gt; IO (Either err [b])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b] -&gt; Either err [b]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>        </span><span id="local-6989586621679119405"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679119405"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679119404"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679119404"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-349"></span><span>          </span><span id="local-6989586621679119403"><span class="annot"><span class="annottext">Either err b
</span><a href="#local-6989586621679119403"><span class="hs-identifier hs-var">eitherB</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either err b)
</span><a href="#local-6989586621679119408"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679119405"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-350"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either err b
</span><a href="#local-6989586621679119403"><span class="hs-identifier hs-var">eitherB</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-351"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679119402"><span class="annot"><span class="annottext">err
</span><a href="#local-6989586621679119402"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-352"></span><span>              </span><span class="annot"><span class="annottext">Either err [b] -&gt; IO (Either err [b])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">err -&gt; Either err [b]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">err
</span><a href="#local-6989586621679119402"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679119401"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679119401"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>              </span><span id="local-6989586621679119400"><span class="annot"><span class="annottext">Either err [b]
</span><a href="#local-6989586621679119400"><span class="hs-identifier hs-var">eitherBS</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; IO (Either err [b])
</span><a href="#local-6989586621679119407"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679119404"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-355"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either err [b]
</span><a href="#local-6989586621679119400"><span class="hs-identifier hs-var">eitherBS</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-356"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679119399"><span class="annot"><span class="annottext">err
</span><a href="#local-6989586621679119399"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>                  </span><span class="annot"><span class="annottext">Either err [b] -&gt; IO (Either err [b])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">err -&gt; Either err [b]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">err
</span><a href="#local-6989586621679119399"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679119398"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679119398"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-359"></span><span>                  </span><span class="annot"><span class="annottext">Either err [b] -&gt; IO (Either err [b])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[b] -&gt; Either err [b]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679119401"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679119398"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">{- |
  Attempts to decode a result set row that has already been fetched from the
  database server into a Haskell value. If the decoding fails, a 'MarshallError'
  will be returned.
-}</span><span>
</span><span id="line-366"></span><span id="local-6989586621679119735"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#decodeRow"><span class="hs-identifier hs-type">decodeRow</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ErrorDetailLevel.html#ErrorDetailLevel"><span class="hs-identifier hs-type">ErrorDetailLevel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119735"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowIdentityExtractor"><span class="hs-identifier hs-type">RowIdentityExtractor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Row"><span class="hs-identifier hs-type">Row</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.MarshallError.html#MarshallError"><span class="hs-identifier hs-type">MarshallError.MarshallError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119735"><span class="hs-identifier hs-type">readEntity</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-372"></span><span id="decodeRow"><span class="annot"><span class="annottext">decodeRow :: ErrorDetailLevel
-&gt; RowSource readEntity
-&gt; RowIdentityExtractor
-&gt; Row
-&gt; IO (Either MarshallError readEntity)
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#decodeRow"><span class="hs-identifier hs-var hs-var">decodeRow</span></a></span></span><span> </span><span id="local-6989586621679119397"><span class="annot"><span class="annottext">ErrorDetailLevel
</span><a href="#local-6989586621679119397"><span class="hs-identifier hs-var">errorDetailLevel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span id="local-6989586621679119395"><span class="annot"><span class="annottext">Row -&gt; IO (Either MarshallErrorDetails readEntity)
</span><a href="#local-6989586621679119395"><span class="hs-identifier hs-var">source</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowIdentityExtractor"><span class="hs-identifier hs-type">RowIdentityExtractor</span></a></span><span> </span><span id="local-6989586621679119393"><span class="annot"><span class="annottext">Row -&gt; IO [(ByteString, SqlValue)]
</span><a href="#local-6989586621679119393"><span class="hs-identifier hs-var">getRowId</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679119392"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119392"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679119391"><span class="annot"><span class="annottext">Either MarshallErrorDetails readEntity
</span><a href="#local-6989586621679119391"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Row -&gt; IO (Either MarshallErrorDetails readEntity)
</span><a href="#local-6989586621679119395"><span class="hs-identifier hs-var">source</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119392"><span class="hs-identifier hs-var">row</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either MarshallErrorDetails readEntity
</span><a href="#local-6989586621679119391"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679119390"><span class="annot"><span class="annottext">MarshallErrorDetails
</span><a href="#local-6989586621679119390"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-376"></span><span>      </span><span id="local-6989586621679119389"><span class="annot"><span class="annottext">[(ByteString, SqlValue)]
</span><a href="#local-6989586621679119389"><span class="hs-identifier hs-var">rowId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Row -&gt; IO [(ByteString, SqlValue)]
</span><a href="#local-6989586621679119393"><span class="hs-identifier hs-var">getRowId</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119392"><span class="hs-identifier hs-var">row</span></a></span><span>
</span><span id="line-377"></span><span>      </span><span class="annot"><span class="annottext">Either MarshallError readEntity
-&gt; IO (Either MarshallError readEntity)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either MarshallError readEntity
 -&gt; IO (Either MarshallError readEntity))
-&gt; Either MarshallError readEntity
-&gt; IO (Either MarshallError readEntity)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-378"></span><span>        </span><span class="annot"><span class="annottext">MarshallError -&gt; Either MarshallError readEntity
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(MarshallError -&gt; Either MarshallError readEntity)
-&gt; MarshallError -&gt; Either MarshallError readEntity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-379"></span><span>          </span><span class="annot"><span class="annottext">MarshallError :: ErrorDetailLevel
-&gt; [(ByteString, SqlValue)]
-&gt; MarshallErrorDetails
-&gt; MarshallError
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#MarshallError"><span class="hs-identifier hs-type">MarshallError.MarshallError</span></a></span><span>
</span><span id="line-380"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">marshallErrorDetailLevel :: ErrorDetailLevel
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#marshallErrorDetailLevel"><span class="hs-identifier hs-var">MarshallError.marshallErrorDetailLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorDetailLevel
</span><a href="#local-6989586621679119397"><span class="hs-identifier hs-var">errorDetailLevel</span></a></span><span>
</span><span id="line-381"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">marshallErrorRowIdentifier :: [(ByteString, SqlValue)]
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#marshallErrorRowIdentifier"><span class="hs-identifier hs-var">MarshallError.marshallErrorRowIdentifier</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, SqlValue)]
</span><a href="#local-6989586621679119389"><span class="hs-identifier hs-var">rowId</span></a></span><span>
</span><span id="line-382"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">marshallErrorDetails :: MarshallErrorDetails
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#marshallErrorDetails"><span class="hs-identifier hs-var">MarshallError.marshallErrorDetails</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MarshallErrorDetails
</span><a href="#local-6989586621679119390"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-383"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679119384"><span class="annot"><span class="annottext">readEntity
</span><a href="#local-6989586621679119384"><span class="hs-identifier hs-var">entity</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-385"></span><span>      </span><span class="annot"><span class="annottext">Either MarshallError readEntity
-&gt; IO (Either MarshallError readEntity)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either MarshallError readEntity
 -&gt; IO (Either MarshallError readEntity))
-&gt; Either MarshallError readEntity
-&gt; IO (Either MarshallError readEntity)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-386"></span><span>        </span><span class="annot"><span class="annottext">readEntity -&gt; Either MarshallError readEntity
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">readEntity
</span><a href="#local-6989586621679119384"><span class="hs-identifier hs-var">entity</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">{- |
  A 'RowSource' can fetch and decode rows from a database result set. Using
  a 'RowSource' gives random access to the rows in the result set, only
  attempting to decode them when they are requested by the use via 'decodeRow'.

  Note that even though the rows are not decoded into Haskell until 'decodeRow'
  is called, all the rows returned from the query are held in memory on the
  client waiting to be decoded until the 'RowSource' is garbage collected.
  As such, you can't use 'RowSource' (alone) to achieve any form of streaming
  or pagination of rows between the database server and the client.
-}</span><span>
</span><span id="line-399"></span><span class="hs-keyword">newtype</span><span> </span><span id="RowSource"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-var">RowSource</span></a></span></span><span> </span><span id="local-6989586621679119711"><span class="annot"><a href="#local-6989586621679119711"><span class="hs-identifier hs-type">readEntity</span></a></span></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RowSource"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-var">RowSource</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Row"><span class="hs-identifier hs-type">Row</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.MarshallError.html#MarshallErrorDetails"><span class="hs-identifier hs-type">MarshallError.MarshallErrorDetails</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119711"><span class="hs-identifier hs-type">readEntity</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119381"><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-403"></span><span>  </span><span id="local-6989586621679119380"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; RowSource a -&gt; RowSource b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; RowSource a -&gt; RowSource b
forall a b. (a -&gt; b) -&gt; RowSource a -&gt; RowSource b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mapRowSource"><span class="hs-identifier hs-var">mapRowSource</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679119371"><span id="local-6989586621679119373"><span id="local-6989586621679119375"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-406"></span><span>  </span><span id="local-6989586621679119370"><span class="annot"><span class="annottext">pure :: a -&gt; RowSource a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; RowSource a
forall a. a -&gt; RowSource a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#constRowSource"><span class="hs-identifier hs-var">constRowSource</span></a></span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621679119369"><span class="annot"><span class="annottext">&lt;*&gt; :: RowSource (a -&gt; b) -&gt; RowSource a -&gt; RowSource b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;*&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RowSource (a -&gt; b) -&gt; RowSource a -&gt; RowSource b
forall a b. RowSource (a -&gt; b) -&gt; RowSource a -&gt; RowSource b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#applyRowSource"><span class="hs-identifier hs-var">applyRowSource</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">{- |
  Adds a function to the decoding proocess to transform the value returned
  by a 'RowSource'.
-}</span><span>
</span><span id="line-413"></span><span id="local-6989586621679119367"><span id="local-6989586621679119368"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mapRowSource"><span class="hs-identifier hs-type">mapRowSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119368"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119367"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119368"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119367"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-414"></span><span id="mapRowSource"><span class="annot"><span class="annottext">mapRowSource :: (a -&gt; b) -&gt; RowSource a -&gt; RowSource b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mapRowSource"><span class="hs-identifier hs-var hs-var">mapRowSource</span></a></span></span><span> </span><span id="local-6989586621679119366"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679119366"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span id="local-6989586621679119365"><span class="annot"><span class="annottext">Row -&gt; IO (Either MarshallErrorDetails a)
</span><a href="#local-6989586621679119365"><span class="hs-identifier hs-var">decodeA</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-415"></span><span>  </span><span class="annot"><span class="annottext">(Row -&gt; IO (Either MarshallErrorDetails b)) -&gt; RowSource b
forall readEntity.
(Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; RowSource readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-var">RowSource</span></a></span><span> </span><span class="annot"><span class="annottext">((Row -&gt; IO (Either MarshallErrorDetails b)) -&gt; RowSource b)
-&gt; (Row -&gt; IO (Either MarshallErrorDetails b)) -&gt; RowSource b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679119364"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119364"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Either MarshallErrorDetails a -&gt; Either MarshallErrorDetails b)
-&gt; IO (Either MarshallErrorDetails a)
-&gt; IO (Either MarshallErrorDetails b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b)
-&gt; Either MarshallErrorDetails a -&gt; Either MarshallErrorDetails b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679119366"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Row -&gt; IO (Either MarshallErrorDetails a)
</span><a href="#local-6989586621679119365"><span class="hs-identifier hs-var">decodeA</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119364"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">{- |
  Creates a 'RowSource' that always returns the value given, rather than
  attempting to access the result set and decoding anything.
-}</span><span>
</span><span id="line-421"></span><span id="local-6989586621679119363"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#constRowSource"><span class="hs-identifier hs-type">constRowSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679119363"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119363"><span class="hs-identifier hs-type">readEntity</span></a></span></span><span>
</span><span id="line-422"></span><span id="constRowSource"><span class="annot"><span class="annottext">constRowSource :: readEntity -&gt; RowSource readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#constRowSource"><span class="hs-identifier hs-var hs-var">constRowSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><span class="annottext">(Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; RowSource readEntity
forall readEntity.
(Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; RowSource readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-var">RowSource</span></a></span><span> </span><span class="annot"><span class="annottext">((Row -&gt; IO (Either MarshallErrorDetails readEntity))
 -&gt; RowSource readEntity)
-&gt; (readEntity
    -&gt; Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; readEntity
-&gt; RowSource readEntity
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Either MarshallErrorDetails readEntity)
-&gt; Row -&gt; IO (Either MarshallErrorDetails readEntity)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either MarshallErrorDetails readEntity)
 -&gt; Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; (readEntity -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; readEntity
-&gt; Row
-&gt; IO (Either MarshallErrorDetails readEntity)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either MarshallErrorDetails readEntity
-&gt; IO (Either MarshallErrorDetails readEntity)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either MarshallErrorDetails readEntity
 -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; (readEntity -&gt; Either MarshallErrorDetails readEntity)
-&gt; readEntity
-&gt; IO (Either MarshallErrorDetails readEntity)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">readEntity -&gt; Either MarshallErrorDetails readEntity
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-comment">{- |
  Applies a function that will be decoded from the result set to another
  value decode from the result set.
-}</span><span>
</span><span id="line-429"></span><span id="local-6989586621679119360"><span id="local-6989586621679119361"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#applyRowSource"><span class="hs-identifier hs-type">applyRowSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119361"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119360"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119361"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119360"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-430"></span><span id="applyRowSource"><span class="annot"><span class="annottext">applyRowSource :: RowSource (a -&gt; b) -&gt; RowSource a -&gt; RowSource b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#applyRowSource"><span class="hs-identifier hs-var hs-var">applyRowSource</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span id="local-6989586621679119359"><span class="annot"><span class="annottext">Row -&gt; IO (Either MarshallErrorDetails (a -&gt; b))
</span><a href="#local-6989586621679119359"><span class="hs-identifier hs-var">decodeAtoB</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span id="local-6989586621679119358"><span class="annot"><span class="annottext">Row -&gt; IO (Either MarshallErrorDetails a)
</span><a href="#local-6989586621679119358"><span class="hs-identifier hs-var">decodeA</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-431"></span><span>  </span><span class="annot"><span class="annottext">(Row -&gt; IO (Either MarshallErrorDetails b)) -&gt; RowSource b
forall readEntity.
(Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; RowSource readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-var">RowSource</span></a></span><span> </span><span class="annot"><span class="annottext">((Row -&gt; IO (Either MarshallErrorDetails b)) -&gt; RowSource b)
-&gt; (Row -&gt; IO (Either MarshallErrorDetails b)) -&gt; RowSource b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679119357"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119357"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-432"></span><span>    </span><span id="local-6989586621679119356"><span class="annot"><span class="annottext">Either MarshallErrorDetails (a -&gt; b)
</span><a href="#local-6989586621679119356"><span class="hs-identifier hs-var">eitherAToB</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Row -&gt; IO (Either MarshallErrorDetails (a -&gt; b))
</span><a href="#local-6989586621679119359"><span class="hs-identifier hs-var">decodeAtoB</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119357"><span class="hs-identifier hs-var">row</span></a></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either MarshallErrorDetails (a -&gt; b)
</span><a href="#local-6989586621679119356"><span class="hs-identifier hs-var">eitherAToB</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-435"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679119355"><span class="annot"><span class="annottext">MarshallErrorDetails
</span><a href="#local-6989586621679119355"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-436"></span><span>        </span><span class="annot"><span class="annottext">Either MarshallErrorDetails b -&gt; IO (Either MarshallErrorDetails b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MarshallErrorDetails -&gt; Either MarshallErrorDetails b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">MarshallErrorDetails
</span><a href="#local-6989586621679119355"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679119354"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679119354"><span class="hs-identifier hs-var">aToB</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-438"></span><span>        </span><span id="local-6989586621679119353"><span class="annot"><span class="annottext">Either MarshallErrorDetails a
</span><a href="#local-6989586621679119353"><span class="hs-identifier hs-var">eitherA</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Row -&gt; IO (Either MarshallErrorDetails a)
</span><a href="#local-6989586621679119358"><span class="hs-identifier hs-var">decodeA</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119357"><span class="hs-identifier hs-var">row</span></a></span><span>
</span><span id="line-439"></span><span>        </span><span class="annot"><span class="annottext">Either MarshallErrorDetails b -&gt; IO (Either MarshallErrorDetails b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b)
-&gt; Either MarshallErrorDetails a -&gt; Either MarshallErrorDetails b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679119354"><span class="hs-identifier hs-var">aToB</span></a></span><span> </span><span class="annot"><span class="annottext">Either MarshallErrorDetails a
</span><a href="#local-6989586621679119353"><span class="hs-identifier hs-var">eitherA</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">{- |
  Creates a 'RowSource' that will always fail to decode by returning the
  provided error. This can be used in cases where a 'RowSource' must
  be provided but it is already known at run time that decoding is impossible.
  For instance, this is used internally when a 'FieldDefinition' references
  a column that does not exist in the result set.
-}</span><span>
</span><span id="line-448"></span><span id="local-6989586621679119661"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#failRowSource"><span class="hs-identifier hs-type">failRowSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.MarshallError.html#MarshallErrorDetails"><span class="hs-identifier hs-type">MarshallError.MarshallErrorDetails</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119661"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-449"></span><span id="failRowSource"><span class="annot"><span class="annottext">failRowSource :: MarshallErrorDetails -&gt; RowSource a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#failRowSource"><span class="hs-identifier hs-var hs-var">failRowSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><span class="annottext">(Row -&gt; IO (Either MarshallErrorDetails a)) -&gt; RowSource a
forall readEntity.
(Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; RowSource readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-var">RowSource</span></a></span><span> </span><span class="annot"><span class="annottext">((Row -&gt; IO (Either MarshallErrorDetails a)) -&gt; RowSource a)
-&gt; (MarshallErrorDetails
    -&gt; Row -&gt; IO (Either MarshallErrorDetails a))
-&gt; MarshallErrorDetails
-&gt; RowSource a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Either MarshallErrorDetails a)
-&gt; Row -&gt; IO (Either MarshallErrorDetails a)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either MarshallErrorDetails a)
 -&gt; Row -&gt; IO (Either MarshallErrorDetails a))
-&gt; (MarshallErrorDetails -&gt; IO (Either MarshallErrorDetails a))
-&gt; MarshallErrorDetails
-&gt; Row
-&gt; IO (Either MarshallErrorDetails a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either MarshallErrorDetails a -&gt; IO (Either MarshallErrorDetails a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either MarshallErrorDetails a
 -&gt; IO (Either MarshallErrorDetails a))
-&gt; (MarshallErrorDetails -&gt; Either MarshallErrorDetails a)
-&gt; MarshallErrorDetails
-&gt; IO (Either MarshallErrorDetails a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MarshallErrorDetails -&gt; Either MarshallErrorDetails a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-comment">{- |
  Uses the 'SqlMarshaller' given to build a 'RowSource' that will decode
  from the given result set. The returned 'RowSource' can then be used to
  decode rows as desired by the user. Note that the entire result set is
  held in memory for potential decoding until the 'RowSource' is garbage
  collected.
-}</span><span>
</span><span id="line-459"></span><span id="local-6989586621679119739"><span id="local-6989586621679119740"><span id="local-6989586621679119741"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkRowSource"><span class="hs-identifier hs-type">mkRowSource</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#ExecutionResult"><span class="hs-identifier hs-type">ExecutionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119741"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119740"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119739"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-462"></span><span>  </span><span class="annot"><a href="#local-6989586621679119741"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119739"><span class="hs-identifier hs-type">readEntity</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-464"></span><span id="mkRowSource"><span class="annot"><span class="annottext">mkRowSource :: SqlMarshaller writeEntity readEntity
-&gt; result -&gt; IO (RowSource readEntity)
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkRowSource"><span class="hs-identifier hs-var hs-var">mkRowSource</span></a></span></span><span> </span><span id="local-6989586621679119352"><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119352"><span class="hs-identifier hs-var">marshaller</span></a></span></span><span> </span><span id="local-6989586621679119351"><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119351"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-465"></span><span>  </span><span id="local-6989586621679119350"><span class="annot"><span class="annottext">Map ByteString Column
</span><a href="#local-6989586621679119350"><span class="hs-identifier hs-var">columnMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">result -&gt; IO (Map ByteString Column)
forall result.
ExecutionResult result =&gt;
result -&gt; IO (Map ByteString Column)
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#prepareColumnMap"><span class="hs-identifier hs-var">prepareColumnMap</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119351"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119694"><span id="local-6989586621679119695"><span class="annot"><a href="#local-6989586621679119348"><span class="hs-identifier hs-type">mkSource</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119695"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119694"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119694"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-468"></span><span>      </span><span id="local-6989586621679119348"><span class="annot"><span class="annottext">mkSource :: SqlMarshaller a b -&gt; RowSource b
</span><a href="#local-6989586621679119348"><span class="hs-identifier hs-var hs-var">mkSource</span></a></span></span><span> </span><span id="local-6989586621679119347"><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119347"><span class="hs-identifier hs-var">marshallerPart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-469"></span><span>        </span><span class="hs-comment">-- Note, this case statement is evaluated before the row argument is</span><span>
</span><span id="line-470"></span><span>        </span><span class="hs-comment">-- ever passed to a 'RowSource' to ensure that a single 'RowSource'</span><span>
</span><span id="line-471"></span><span>        </span><span class="hs-comment">-- operation is build and re-used when decoding many rows.</span><span>
</span><span id="line-472"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119347"><span class="hs-identifier hs-var">marshallerPart</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-473"></span><span>          </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPure"><span class="hs-identifier hs-type">MarshallPure</span></a></span><span> </span><span id="local-6989586621679119346"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679119346"><span class="hs-identifier hs-var">readEntity</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-474"></span><span>            </span><span class="annot"><span class="annottext">b -&gt; RowSource b
forall a. a -&gt; RowSource a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#constRowSource"><span class="hs-identifier hs-var">constRowSource</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679119346"><span class="hs-identifier hs-var">readEntity</span></a></span><span>
</span><span id="line-475"></span><span>          </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallApply"><span class="hs-identifier hs-type">MarshallApply</span></a></span><span> </span><span id="local-6989586621679119345"><span class="annot"><span class="annottext">SqlMarshaller a (b -&gt; b)
</span><a href="#local-6989586621679119345"><span class="hs-identifier hs-var">marshallAToB</span></a></span></span><span> </span><span id="local-6989586621679119344"><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119344"><span class="hs-identifier hs-var">marshallA</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-476"></span><span>            </span><span class="annot"><span class="annottext">SqlMarshaller a (b -&gt; b) -&gt; RowSource (b -&gt; b)
forall a b. SqlMarshaller a b -&gt; RowSource b
</span><a href="#local-6989586621679119348"><span class="hs-identifier hs-var">mkSource</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (b -&gt; b)
</span><a href="#local-6989586621679119345"><span class="hs-identifier hs-var">marshallAToB</span></a></span><span> </span><span class="annot"><span class="annottext">RowSource (b -&gt; b) -&gt; RowSource b -&gt; RowSource b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b -&gt; RowSource b
forall a b. SqlMarshaller a b -&gt; RowSource b
</span><a href="#local-6989586621679119348"><span class="hs-identifier hs-var">mkSource</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119344"><span class="hs-identifier hs-var">marshallA</span></a></span><span>
</span><span id="line-477"></span><span>          </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallNest"><span class="hs-identifier hs-type">MarshallNest</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679119343"><span class="annot"><span class="annottext">SqlMarshaller b b
</span><a href="#local-6989586621679119343"><span class="hs-identifier hs-var">someMarshaller</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-478"></span><span>            </span><span class="annot"><span class="annottext">SqlMarshaller b b -&gt; RowSource b
forall a b. SqlMarshaller a b -&gt; RowSource b
</span><a href="#local-6989586621679119348"><span class="hs-identifier hs-var">mkSource</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller b b
</span><a href="#local-6989586621679119343"><span class="hs-identifier hs-var">someMarshaller</span></a></span><span>
</span><span id="line-479"></span><span>          </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallField"><span class="hs-identifier hs-type">MarshallField</span></a></span><span> </span><span id="local-6989586621679119342"><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119342"><span class="hs-identifier hs-var">fieldDef</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-480"></span><span>            </span><span class="annot"><span class="annottext">FieldName
-&gt; (SqlValue -&gt; Either String a)
-&gt; Map ByteString Column
-&gt; result
-&gt; RowSource a
forall result a.
ExecutionResult result =&gt;
FieldName
-&gt; (SqlValue -&gt; Either String a)
-&gt; Map ByteString Column
-&gt; result
-&gt; RowSource a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkFieldNameSource"><span class="hs-identifier hs-var">mkFieldNameSource</span></a></span><span>
</span><span id="line-481"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDefinition nullability a -&gt; FieldName
forall nullability a. FieldDefinition nullability a -&gt; FieldName
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119342"><span class="hs-identifier hs-var">fieldDef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDefinition nullability a -&gt; SqlValue -&gt; Either String a
forall nullability a.
FieldDefinition nullability a -&gt; SqlValue -&gt; Either String a
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldValueFromSqlValue"><span class="hs-identifier hs-var">fieldValueFromSqlValue</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119342"><span class="hs-identifier hs-var">fieldDef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>              </span><span class="annot"><span class="annottext">Map ByteString Column
</span><a href="#local-6989586621679119350"><span class="hs-identifier hs-var">columnMap</span></a></span><span>
</span><span id="line-484"></span><span>              </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119351"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-485"></span><span>          </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallSyntheticField"><span class="hs-identifier hs-type">MarshallSyntheticField</span></a></span><span> </span><span id="local-6989586621679119340"><span class="annot"><span class="annottext">SyntheticField b
</span><a href="#local-6989586621679119340"><span class="hs-identifier hs-var">syntheticField</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-486"></span><span>            </span><span class="annot"><span class="annottext">FieldName
-&gt; (SqlValue -&gt; Either String b)
-&gt; Map ByteString Column
-&gt; result
-&gt; RowSource b
forall result a.
ExecutionResult result =&gt;
FieldName
-&gt; (SqlValue -&gt; Either String a)
-&gt; Map ByteString Column
-&gt; result
-&gt; RowSource a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkFieldNameSource"><span class="hs-identifier hs-var">mkFieldNameSource</span></a></span><span>
</span><span id="line-487"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntheticField b -&gt; FieldName
forall a. SyntheticField a -&gt; FieldName
</span><a href="Orville.PostgreSQL.Internal.SyntheticField.html#syntheticFieldAlias"><span class="hs-identifier hs-var">syntheticFieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">SyntheticField b
</span><a href="#local-6989586621679119340"><span class="hs-identifier hs-var">syntheticField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntheticField b -&gt; SqlValue -&gt; Either String b
forall a. SyntheticField a -&gt; SqlValue -&gt; Either String a
</span><a href="Orville.PostgreSQL.Internal.SyntheticField.html#syntheticFieldValueFromSqlValue"><span class="hs-identifier hs-var">syntheticFieldValueFromSqlValue</span></a></span><span> </span><span class="annot"><span class="annottext">SyntheticField b
</span><a href="#local-6989586621679119340"><span class="hs-identifier hs-var">syntheticField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>              </span><span class="annot"><span class="annottext">Map ByteString Column
</span><a href="#local-6989586621679119350"><span class="hs-identifier hs-var">columnMap</span></a></span><span>
</span><span id="line-490"></span><span>              </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119351"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-491"></span><span>          </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallMaybeTag"><span class="hs-identifier hs-type">MarshallMaybeTag</span></a></span><span> </span><span id="local-6989586621679119339"><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119339"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-492"></span><span>            </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b) -&gt; RowSource (Maybe b)
forall a b. SqlMarshaller a b -&gt; RowSource b
</span><a href="#local-6989586621679119348"><span class="hs-identifier hs-var">mkSource</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119339"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-493"></span><span>          </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPartial"><span class="hs-identifier hs-type">MarshallPartial</span></a></span><span> </span><span id="local-6989586621679119338"><span class="annot"><span class="annottext">SqlMarshaller a (Either String b)
</span><a href="#local-6989586621679119338"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-494"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119337"><span class="annot"><span class="annottext">fieldNames :: [FieldName]
</span><a href="#local-6989586621679119337"><span class="hs-identifier hs-var hs-var">fieldNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-495"></span><span>                  </span><span class="annot"><span class="annottext">SqlMarshaller a (Either String b)
-&gt; [FieldName]
-&gt; (MarshallerField a -&gt; [FieldName] -&gt; [FieldName])
-&gt; [FieldName]
forall writeEntity readEntity result.
SqlMarshaller writeEntity readEntity
-&gt; result
-&gt; (MarshallerField writeEntity -&gt; result -&gt; result)
-&gt; result
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#foldMarshallerFields"><span class="hs-identifier hs-var">foldMarshallerFields</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (Either String b)
</span><a href="#local-6989586621679119338"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((MarshallerField a -&gt; [FieldName] -&gt; [FieldName]) -&gt; [FieldName])
-&gt; (MarshallerField a -&gt; [FieldName] -&gt; [FieldName]) -&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679119336"><span class="annot"><span class="annottext">MarshallerField a
</span><a href="#local-6989586621679119336"><span class="hs-identifier hs-var">marshallerField</span></a></span></span><span> </span><span id="local-6989586621679119335"><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621679119335"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-496"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MarshallerField a
</span><a href="#local-6989586621679119336"><span class="hs-identifier hs-var">marshallerField</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-497"></span><span>                      </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Natural"><span class="hs-identifier hs-type">Natural</span></a></span><span> </span><span id="local-6989586621679119334"><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119334"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (a -&gt; a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-498"></span><span>                        </span><span class="annot"><span class="annottext">FieldDefinition nullability a -&gt; FieldName
forall nullability a. FieldDefinition nullability a -&gt; FieldName
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldName"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119334"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [FieldName] -&gt; [FieldName]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621679119335"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-499"></span><span>                      </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#Synthetic"><span class="hs-identifier hs-type">Synthetic</span></a></span><span> </span><span id="local-6989586621679119333"><span class="annot"><span class="annottext">SyntheticField a
</span><a href="#local-6989586621679119333"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-500"></span><span>                        </span><span class="annot"><span class="annottext">SyntheticField a -&gt; FieldName
forall a. SyntheticField a -&gt; FieldName
</span><a href="Orville.PostgreSQL.Internal.SyntheticField.html#syntheticFieldAlias"><span class="hs-identifier hs-var">syntheticFieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">SyntheticField a
</span><a href="#local-6989586621679119333"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; [FieldName] -&gt; [FieldName]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621679119335"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-501"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[FieldName]
-&gt; Map ByteString Column
-&gt; result
-&gt; RowSource (Either String b)
-&gt; RowSource b
forall result readEntity.
ExecutionResult result =&gt;
[FieldName]
-&gt; Map ByteString Column
-&gt; result
-&gt; RowSource (Either String readEntity)
-&gt; RowSource readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#partialRowSource"><span class="hs-identifier hs-var">partialRowSource</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621679119337"><span class="hs-identifier hs-var">fieldNames</span></a></span><span> </span><span class="annot"><span class="annottext">Map ByteString Column
</span><a href="#local-6989586621679119350"><span class="hs-identifier hs-var">columnMap</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119351"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SqlMarshaller a (Either String b) -&gt; RowSource (Either String b)
forall a b. SqlMarshaller a b -&gt; RowSource b
</span><a href="#local-6989586621679119348"><span class="hs-identifier hs-var">mkSource</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (Either String b)
</span><a href="#local-6989586621679119338"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>          </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallReadOnly"><span class="hs-identifier hs-type">MarshallReadOnly</span></a></span><span> </span><span id="local-6989586621679119331"><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119331"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-503"></span><span>            </span><span class="annot"><span class="annottext">SqlMarshaller a b -&gt; RowSource b
forall a b. SqlMarshaller a b -&gt; RowSource b
</span><a href="#local-6989586621679119348"><span class="hs-identifier hs-var">mkSource</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119331"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span>  </span><span class="annot"><span class="annottext">RowSource readEntity -&gt; IO (RowSource readEntity)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(RowSource readEntity -&gt; IO (RowSource readEntity))
-&gt; (SqlMarshaller writeEntity readEntity -&gt; RowSource readEntity)
-&gt; SqlMarshaller writeEntity readEntity
-&gt; IO (RowSource readEntity)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity -&gt; RowSource readEntity
forall a b. SqlMarshaller a b -&gt; RowSource b
</span><a href="#local-6989586621679119348"><span class="hs-identifier hs-var">mkSource</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlMarshaller writeEntity readEntity -&gt; IO (RowSource readEntity))
-&gt; SqlMarshaller writeEntity readEntity
-&gt; IO (RowSource readEntity)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller writeEntity readEntity
</span><a href="#local-6989586621679119352"><span class="hs-identifier hs-var">marshaller</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span id="local-6989586621679119678"><span id="local-6989586621679119679"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#partialRowSource"><span class="hs-identifier hs-type">partialRowSource</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-508"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#ExecutionResult"><span class="hs-identifier hs-type">ExecutionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119679"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-510"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Column"><span class="hs-identifier hs-type">Column</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-511"></span><span>  </span><span class="annot"><a href="#local-6989586621679119679"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679119678"><span class="hs-identifier hs-type">readEntity</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-513"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119678"><span class="hs-identifier hs-type">readEntity</span></a></span></span></span><span>
</span><span id="line-514"></span><span id="partialRowSource"><span class="annot"><span class="annottext">partialRowSource :: [FieldName]
-&gt; Map ByteString Column
-&gt; result
-&gt; RowSource (Either String readEntity)
-&gt; RowSource readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#partialRowSource"><span class="hs-identifier hs-var hs-var">partialRowSource</span></a></span></span><span> </span><span id="local-6989586621679119330"><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621679119330"><span class="hs-identifier hs-var">fieldNames</span></a></span></span><span> </span><span id="local-6989586621679119329"><span class="annot"><span class="annottext">Map ByteString Column
</span><a href="#local-6989586621679119329"><span class="hs-identifier hs-var">columnMap</span></a></span></span><span> </span><span id="local-6989586621679119328"><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119328"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span id="local-6989586621679119327"><span class="annot"><span class="annottext">Row -&gt; IO (Either MarshallErrorDetails (Either String readEntity))
</span><a href="#local-6989586621679119327"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-515"></span><span>  </span><span class="annot"><span class="annottext">(Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; RowSource readEntity
forall readEntity.
(Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; RowSource readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-var">RowSource</span></a></span><span> </span><span class="annot"><span class="annottext">((Row -&gt; IO (Either MarshallErrorDetails readEntity))
 -&gt; RowSource readEntity)
-&gt; (Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; RowSource readEntity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679119326"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119326"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-516"></span><span>    </span><span id="local-6989586621679119325"><span class="annot"><span class="annottext">Either MarshallErrorDetails (Either String readEntity)
</span><a href="#local-6989586621679119325"><span class="hs-identifier hs-var">partialResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Row -&gt; IO (Either MarshallErrorDetails (Either String readEntity))
</span><a href="#local-6989586621679119327"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119326"><span class="hs-identifier hs-var">row</span></a></span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either MarshallErrorDetails (Either String readEntity)
</span><a href="#local-6989586621679119325"><span class="hs-identifier hs-var">partialResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-518"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679119324"><span class="annot"><span class="annottext">MarshallErrorDetails
</span><a href="#local-6989586621679119324"><span class="hs-identifier hs-var">marshallError</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-519"></span><span>        </span><span class="annot"><span class="annottext">Either MarshallErrorDetails readEntity
-&gt; IO (Either MarshallErrorDetails readEntity)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either MarshallErrorDetails readEntity
 -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; Either MarshallErrorDetails readEntity
-&gt; IO (Either MarshallErrorDetails readEntity)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MarshallErrorDetails -&gt; Either MarshallErrorDetails readEntity
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">MarshallErrorDetails
</span><a href="#local-6989586621679119324"><span class="hs-identifier hs-var">marshallError</span></a></span><span>
</span><span id="line-520"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679119323"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679119323"><span class="hs-identifier hs-var">errorMessage</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-521"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119322"><span class="annot"><span class="annottext">columnNames :: [ByteString]
</span><a href="#local-6989586621679119322"><span class="hs-identifier hs-var hs-var">columnNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-522"></span><span>              </span><span class="annot"><span class="annottext">(FieldName -&gt; ByteString) -&gt; [FieldName] -&gt; [ByteString]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; ByteString
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldNameToByteString"><span class="hs-identifier hs-var">fieldNameToByteString</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621679119330"><span class="hs-identifier hs-var">fieldNames</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span>            </span><span id="local-6989586621679119321"><span class="annot"><span class="annottext">lookupValue :: ByteString -&gt; IO (ByteString, SqlValue)
</span><a href="#local-6989586621679119321"><span class="hs-identifier hs-var hs-var">lookupValue</span></a></span></span><span> </span><span id="local-6989586621679119320"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119320"><span class="hs-identifier hs-var">columnName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-525"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Map ByteString Column -&gt; Maybe Column
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119320"><span class="hs-identifier hs-var">columnName</span></a></span><span> </span><span class="annot"><span class="annottext">Map ByteString Column
</span><a href="#local-6989586621679119329"><span class="hs-identifier hs-var">columnMap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-526"></span><span>                </span><span class="annot"><span class="annottext">Maybe Column
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-527"></span><span>                  </span><span class="annot"><span class="annottext">(ByteString, SqlValue) -&gt; IO (ByteString, SqlValue)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119320"><span class="hs-identifier hs-var">columnName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlValue
</span><a href="Orville.PostgreSQL.Internal.SqlValue.html#sqlNull"><span class="hs-identifier hs-var">SqlValue.sqlNull</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679119317"><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119317"><span class="hs-identifier hs-var">columnNumber</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-529"></span><span>                  </span><span id="local-6989586621679119316"><span class="annot"><span class="annottext">SqlValue
</span><a href="#local-6989586621679119316"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">result -&gt; Row -&gt; Column -&gt; IO SqlValue
forall result.
ExecutionResult result =&gt;
result -&gt; Row -&gt; Column -&gt; IO SqlValue
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#getValue"><span class="hs-identifier hs-var">Result.getValue</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119328"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119326"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119317"><span class="hs-identifier hs-var">columnNumber</span></a></span><span>
</span><span id="line-530"></span><span>                  </span><span class="annot"><span class="annottext">(ByteString, SqlValue) -&gt; IO (ByteString, SqlValue)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119320"><span class="hs-identifier hs-var">columnName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlValue
</span><a href="#local-6989586621679119316"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span>        </span><span id="local-6989586621679119314"><span class="annot"><span class="annottext">[(ByteString, SqlValue)]
</span><a href="#local-6989586621679119314"><span class="hs-identifier hs-var">values</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO (ByteString, SqlValue))
-&gt; [ByteString] -&gt; IO [(ByteString, SqlValue)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO (ByteString, SqlValue)
</span><a href="#local-6989586621679119321"><span class="hs-identifier hs-var">lookupValue</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621679119322"><span class="hs-identifier hs-var">columnNames</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span>        </span><span class="annot"><span class="annottext">Either MarshallErrorDetails readEntity
-&gt; IO (Either MarshallErrorDetails readEntity)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either MarshallErrorDetails readEntity
 -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; (DecodingErrorDetails -&gt; Either MarshallErrorDetails readEntity)
-&gt; DecodingErrorDetails
-&gt; IO (Either MarshallErrorDetails readEntity)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MarshallErrorDetails -&gt; Either MarshallErrorDetails readEntity
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(MarshallErrorDetails -&gt; Either MarshallErrorDetails readEntity)
-&gt; (DecodingErrorDetails -&gt; MarshallErrorDetails)
-&gt; DecodingErrorDetails
-&gt; Either MarshallErrorDetails readEntity
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DecodingErrorDetails -&gt; MarshallErrorDetails
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#DecodingError"><span class="hs-identifier hs-var">MarshallError.DecodingError</span></a></span><span> </span><span class="annot"><span class="annottext">(DecodingErrorDetails
 -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; DecodingErrorDetails
-&gt; IO (Either MarshallErrorDetails readEntity)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-535"></span><span>          </span><span class="annot"><span class="annottext">DecodingErrorDetails :: [(ByteString, SqlValue)] -&gt; String -&gt; DecodingErrorDetails
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#DecodingErrorDetails"><span class="hs-identifier hs-type">MarshallError.DecodingErrorDetails</span></a></span><span>
</span><span id="line-536"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">decodingErrorValues :: [(ByteString, SqlValue)]
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#decodingErrorValues"><span class="hs-identifier hs-var">MarshallError.decodingErrorValues</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ByteString, SqlValue)]
</span><a href="#local-6989586621679119314"><span class="hs-identifier hs-var">values</span></a></span><span>
</span><span id="line-537"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">decodingErrorMessage :: String
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#decodingErrorMessage"><span class="hs-identifier hs-var">MarshallError.decodingErrorMessage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679119323"><span class="hs-identifier hs-var">errorMessage</span></a></span><span>
</span><span id="line-538"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-539"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679119308"><span class="annot"><span class="annottext">readEntity
</span><a href="#local-6989586621679119308"><span class="hs-identifier hs-var">entity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-540"></span><span>        </span><span class="annot"><span class="annottext">Either MarshallErrorDetails readEntity
-&gt; IO (Either MarshallErrorDetails readEntity)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either MarshallErrorDetails readEntity
 -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; Either MarshallErrorDetails readEntity
-&gt; IO (Either MarshallErrorDetails readEntity)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">readEntity -&gt; Either MarshallErrorDetails readEntity
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">readEntity
</span><a href="#local-6989586621679119308"><span class="hs-identifier hs-var">entity</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="hs-comment">{- |
  Builds a 'RowSource' that will retrieve and decode the name field from
  the result.
-}</span><span>
</span><span id="line-546"></span><span id="local-6989586621679119690"><span id="local-6989586621679119691"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkFieldNameSource"><span class="hs-identifier hs-type">mkFieldNameSource</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-547"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#ExecutionResult"><span class="hs-identifier hs-type">ExecutionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119691"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-548"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlValue.html#SqlValue"><span class="hs-identifier hs-type">SqlValue.SqlValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679119690"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-550"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Column"><span class="hs-identifier hs-type">Column</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-551"></span><span>  </span><span class="annot"><a href="#local-6989586621679119691"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-552"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119690"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-553"></span><span id="mkFieldNameSource"><span class="annot"><span class="annottext">mkFieldNameSource :: FieldName
-&gt; (SqlValue -&gt; Either String a)
-&gt; Map ByteString Column
-&gt; result
-&gt; RowSource a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkFieldNameSource"><span class="hs-identifier hs-var hs-var">mkFieldNameSource</span></a></span></span><span> </span><span id="local-6989586621679119307"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679119307"><span class="hs-identifier hs-var">sourceFieldName</span></a></span></span><span> </span><span id="local-6989586621679119306"><span class="annot"><span class="annottext">SqlValue -&gt; Either String a
</span><a href="#local-6989586621679119306"><span class="hs-identifier hs-var">fromSqlValue</span></a></span></span><span> </span><span id="local-6989586621679119305"><span class="annot"><span class="annottext">Map ByteString Column
</span><a href="#local-6989586621679119305"><span class="hs-identifier hs-var">columnMap</span></a></span></span><span> </span><span id="local-6989586621679119304"><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119304"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Map ByteString Column -&gt; Maybe Column
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; ByteString
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldNameToByteString"><span class="hs-identifier hs-var">fieldNameToByteString</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679119307"><span class="hs-identifier hs-var">sourceFieldName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map ByteString Column
</span><a href="#local-6989586621679119305"><span class="hs-identifier hs-var">columnMap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679119303"><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119303"><span class="hs-identifier hs-var">columnNumber</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-556"></span><span>      </span><span class="annot"><span class="annottext">FieldName
-&gt; (SqlValue -&gt; Either String a) -&gt; result -&gt; Column -&gt; RowSource a
forall result a.
ExecutionResult result =&gt;
FieldName
-&gt; (SqlValue -&gt; Either String a) -&gt; result -&gt; Column -&gt; RowSource a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkColumnRowSource"><span class="hs-identifier hs-var">mkColumnRowSource</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679119307"><span class="hs-identifier hs-var">sourceFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">SqlValue -&gt; Either String a
</span><a href="#local-6989586621679119306"><span class="hs-identifier hs-var">fromSqlValue</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119304"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119303"><span class="hs-identifier hs-var">columnNumber</span></a></span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><span class="annottext">Maybe Column
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-558"></span><span>      </span><span class="annot"><span class="annottext">MarshallErrorDetails -&gt; RowSource a
forall a. MarshallErrorDetails -&gt; RowSource a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#failRowSource"><span class="hs-identifier hs-var">failRowSource</span></a></span><span> </span><span class="annot"><span class="annottext">(MarshallErrorDetails -&gt; RowSource a)
-&gt; (MissingColumnErrorDetails -&gt; MarshallErrorDetails)
-&gt; MissingColumnErrorDetails
-&gt; RowSource a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">MissingColumnErrorDetails -&gt; MarshallErrorDetails
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#MissingColumnError"><span class="hs-identifier hs-var">MarshallError.MissingColumnError</span></a></span><span> </span><span class="annot"><span class="annottext">(MissingColumnErrorDetails -&gt; RowSource a)
-&gt; MissingColumnErrorDetails -&gt; RowSource a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-559"></span><span>        </span><span class="annot"><span class="annottext">MissingColumnErrorDetails :: ByteString -&gt; Set ByteString -&gt; MissingColumnErrorDetails
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#MissingColumnErrorDetails"><span class="hs-identifier hs-type">MarshallError.MissingColumnErrorDetails</span></a></span><span>
</span><span id="line-560"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">missingColumnName :: ByteString
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#missingColumnName"><span class="hs-identifier hs-var">MarshallError.missingColumnName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; ByteString
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldNameToByteString"><span class="hs-identifier hs-var">fieldNameToByteString</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679119307"><span class="hs-identifier hs-var">sourceFieldName</span></a></span><span>
</span><span id="line-561"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">actualColumnNames :: Set ByteString
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#actualColumnNames"><span class="hs-identifier hs-var">MarshallError.actualColumnNames</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ByteString Column -&gt; Set ByteString
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map ByteString Column
</span><a href="#local-6989586621679119305"><span class="hs-identifier hs-var">columnMap</span></a></span><span>
</span><span id="line-562"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="hs-comment">{- |
  An internal helper function that finds all the column names in a result set
  and associates them with the respective column numbers for easier lookup.
-}</span><span>
</span><span id="line-568"></span><span id="local-6989586621679119699"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#prepareColumnMap"><span class="hs-identifier hs-type">prepareColumnMap</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-569"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#ExecutionResult"><span class="hs-identifier hs-type">ExecutionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119699"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-570"></span><span>  </span><span class="annot"><a href="#local-6989586621679119699"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-571"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Column"><span class="hs-identifier hs-type">Column</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-572"></span><span id="prepareColumnMap"><span class="annot"><span class="annottext">prepareColumnMap :: result -&gt; IO (Map ByteString Column)
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#prepareColumnMap"><span class="hs-identifier hs-var hs-var">prepareColumnMap</span></a></span></span><span> </span><span id="local-6989586621679119296"><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119296"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-573"></span><span>  </span><span id="local-6989586621679119295"><span class="annot"><span class="annottext">Maybe Column
</span><a href="#local-6989586621679119295"><span class="hs-identifier hs-var">mbMaxColumn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">result -&gt; IO (Maybe Column)
forall result.
ExecutionResult result =&gt;
result -&gt; IO (Maybe Column)
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#maxColumnNumber"><span class="hs-identifier hs-var">Result.maxColumnNumber</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119296"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119293"><span class="annot"><span class="annottext">mkNameEntry :: Column -&gt; IO (Maybe (ByteString, Column))
</span><a href="#local-6989586621679119293"><span class="hs-identifier hs-var hs-var">mkNameEntry</span></a></span></span><span> </span><span id="local-6989586621679119292"><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119292"><span class="hs-identifier hs-var">columnNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-576"></span><span>        </span><span id="local-6989586621679119291"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679119291"><span class="hs-identifier hs-var">mbColumnName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">result -&gt; Column -&gt; IO (Maybe ByteString)
forall result.
ExecutionResult result =&gt;
result -&gt; Column -&gt; IO (Maybe ByteString)
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#columnName"><span class="hs-identifier hs-var">Result.columnName</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119296"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119292"><span class="hs-identifier hs-var">columnNumber</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span>        </span><span class="annot"><span class="annottext">Maybe (ByteString, Column) -&gt; IO (Maybe (ByteString, Column))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ByteString, Column) -&gt; IO (Maybe (ByteString, Column)))
-&gt; Maybe (ByteString, Column) -&gt; IO (Maybe (ByteString, Column))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-579"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679119291"><span class="hs-identifier hs-var">mbColumnName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-580"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679119289"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119289"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-581"></span><span>              </span><span class="annot"><span class="annottext">(ByteString, Column) -&gt; Maybe (ByteString, Column)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119289"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119292"><span class="hs-identifier hs-var">columnNumber</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>            </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-583"></span><span>              </span><span class="annot"><span class="annottext">Maybe (ByteString, Column)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Column
</span><a href="#local-6989586621679119295"><span class="hs-identifier hs-var">mbMaxColumn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-586"></span><span>    </span><span class="annot"><span class="annottext">Maybe Column
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><span class="annottext">Map ByteString Column -&gt; IO (Map ByteString Column)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Map ByteString Column
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679119287"><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119287"><span class="hs-identifier hs-var">maxColumn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-589"></span><span>      </span><span id="local-6989586621679119286"><span class="annot"><span class="annottext">[Maybe (ByteString, Column)]
</span><a href="#local-6989586621679119286"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Column -&gt; IO (Maybe (ByteString, Column)))
-&gt; [Column] -&gt; IO [Maybe (ByteString, Column)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Column -&gt; IO (Maybe (ByteString, Column))
</span><a href="#local-6989586621679119293"><span class="hs-identifier hs-var">mkNameEntry</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Column
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Column"><span class="hs-identifier hs-var">Column</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119287"><span class="hs-identifier hs-var">maxColumn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-590"></span><span>      </span><span class="annot"><span class="annottext">Map ByteString Column -&gt; IO (Map ByteString Column)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Map ByteString Column -&gt; IO (Map ByteString Column))
-&gt; Map ByteString Column -&gt; IO (Map ByteString Column)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ByteString, Column)] -&gt; Map ByteString Column
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe (ByteString, Column)] -&gt; [(ByteString, Column)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (ByteString, Column)]
</span><a href="#local-6989586621679119286"><span class="hs-identifier hs-var">entries</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-comment">{- |
  A internal helper function for to build a 'RowSource' that retrieves and
  decodes a single column value form the result set.
-}</span><span>
</span><span id="line-596"></span><span id="local-6989586621679119662"><span id="local-6989586621679119663"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkColumnRowSource"><span class="hs-identifier hs-type">mkColumnRowSource</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-597"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#ExecutionResult"><span class="hs-identifier hs-type">ExecutionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119663"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-598"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlValue.html#SqlValue"><span class="hs-identifier hs-type">SqlValue.SqlValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679119662"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-600"></span><span>  </span><span class="annot"><a href="#local-6989586621679119663"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-601"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Column"><span class="hs-identifier hs-type">Column</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-602"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-type">RowSource</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119662"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-603"></span><span id="mkColumnRowSource"><span class="annot"><span class="annottext">mkColumnRowSource :: FieldName
-&gt; (SqlValue -&gt; Either String a) -&gt; result -&gt; Column -&gt; RowSource a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkColumnRowSource"><span class="hs-identifier hs-var hs-var">mkColumnRowSource</span></a></span></span><span> </span><span id="local-6989586621679119284"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679119284"><span class="hs-identifier hs-var">sourceFieldName</span></a></span></span><span> </span><span id="local-6989586621679119283"><span class="annot"><span class="annottext">SqlValue -&gt; Either String a
</span><a href="#local-6989586621679119283"><span class="hs-identifier hs-var">fromSqlValue</span></a></span></span><span> </span><span id="local-6989586621679119282"><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119282"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621679119281"><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119281"><span class="hs-identifier hs-var">column</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-604"></span><span>  </span><span class="annot"><span class="annottext">(Row -&gt; IO (Either MarshallErrorDetails a)) -&gt; RowSource a
forall readEntity.
(Row -&gt; IO (Either MarshallErrorDetails readEntity))
-&gt; RowSource readEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowSource"><span class="hs-identifier hs-var">RowSource</span></a></span><span> </span><span class="annot"><span class="annottext">((Row -&gt; IO (Either MarshallErrorDetails a)) -&gt; RowSource a)
-&gt; (Row -&gt; IO (Either MarshallErrorDetails a)) -&gt; RowSource a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679119280"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119280"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-605"></span><span>    </span><span id="local-6989586621679119279"><span class="annot"><span class="annottext">SqlValue
</span><a href="#local-6989586621679119279"><span class="hs-identifier hs-var">sqlValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">result -&gt; Row -&gt; Column -&gt; IO SqlValue
forall result.
ExecutionResult result =&gt;
result -&gt; Row -&gt; Column -&gt; IO SqlValue
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#getValue"><span class="hs-identifier hs-var">Result.getValue</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119282"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119280"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119281"><span class="hs-identifier hs-var">column</span></a></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SqlValue -&gt; Either String a
</span><a href="#local-6989586621679119283"><span class="hs-identifier hs-var">fromSqlValue</span></a></span><span> </span><span class="annot"><span class="annottext">SqlValue
</span><a href="#local-6989586621679119279"><span class="hs-identifier hs-var">sqlValue</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-608"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679119278"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679119278"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-609"></span><span>        </span><span class="annot"><span class="annottext">Either MarshallErrorDetails a -&gt; IO (Either MarshallErrorDetails a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either MarshallErrorDetails a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679119278"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679119277"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679119277"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-611"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119276"><span class="annot"><span class="annottext">details :: DecodingErrorDetails
</span><a href="#local-6989586621679119276"><span class="hs-identifier hs-var hs-var">details</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-612"></span><span>              </span><span class="annot"><span class="annottext">DecodingErrorDetails :: [(ByteString, SqlValue)] -&gt; String -&gt; DecodingErrorDetails
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#DecodingErrorDetails"><span class="hs-identifier hs-type">MarshallError.DecodingErrorDetails</span></a></span><span>
</span><span id="line-613"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">decodingErrorValues :: [(ByteString, SqlValue)]
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#decodingErrorValues"><span class="hs-identifier hs-var">MarshallError.decodingErrorValues</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; ByteString
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldNameToByteString"><span class="hs-identifier hs-var">fieldNameToByteString</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621679119284"><span class="hs-identifier hs-var">sourceFieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlValue
</span><a href="#local-6989586621679119279"><span class="hs-identifier hs-var">sqlValue</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-614"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">decodingErrorMessage :: String
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#decodingErrorMessage"><span class="hs-identifier hs-var">MarshallError.decodingErrorMessage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679119277"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-615"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-616"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Either MarshallErrorDetails a -&gt; IO (Either MarshallErrorDetails a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MarshallErrorDetails -&gt; Either MarshallErrorDetails a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(MarshallErrorDetails -&gt; Either MarshallErrorDetails a)
-&gt; MarshallErrorDetails -&gt; Either MarshallErrorDetails a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DecodingErrorDetails -&gt; MarshallErrorDetails
</span><a href="Orville.PostgreSQL.Internal.MarshallError.html#DecodingError"><span class="hs-identifier hs-var">MarshallError.DecodingError</span></a></span><span> </span><span class="annot"><span class="annottext">DecodingErrorDetails
</span><a href="#local-6989586621679119276"><span class="hs-identifier hs-var">details</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="hs-comment">{- |
  A 'RowIdentityExtractor' is used to retrieve identifying information
  for a row when a 'MarshallError' occurs reading it from the database.

  You should only need to worry about this type if you're using
  'marshallResultFromSqlUsingRowIdExtractor' and need to manually provide it.
  When possible, it's easier to annotate a 'SqlMarshaller' with the field names
  you would like rows to be identified by and then use 'marshallResultFromSql'
  instead.
-}</span><span>
</span><span id="line-628"></span><span class="hs-keyword">newtype</span><span> </span><span id="RowIdentityExtractor"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowIdentityExtractor"><span class="hs-identifier hs-var">RowIdentityExtractor</span></a></span></span><span>
</span><span id="line-629"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RowIdentityExtractor"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowIdentityExtractor"><span class="hs-identifier hs-var">RowIdentityExtractor</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Row"><span class="hs-identifier hs-type">Row</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">B8.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlValue.html#SqlValue"><span class="hs-identifier hs-type">SqlValue.SqlValue</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span class="hs-comment">{- |
  Constructs a 'RowIdentityExtractor' that will extract values for the given
  fields from the result set to indentify rows in decoding errors. Any of the
  named fields that are missing from the result set not be included in the
  extracted row identity.
-}</span><span>
</span><span id="line-637"></span><span id="local-6989586621679119750"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkRowIdentityExtractor"><span class="hs-identifier hs-type">mkRowIdentityExtractor</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-638"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#ExecutionResult"><span class="hs-identifier hs-type">ExecutionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119750"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-639"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-640"></span><span>  </span><span class="annot"><a href="#local-6989586621679119750"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-641"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowIdentityExtractor"><span class="hs-identifier hs-type">RowIdentityExtractor</span></a></span></span><span>
</span><span id="line-642"></span><span id="mkRowIdentityExtractor"><span class="annot"><span class="annottext">mkRowIdentityExtractor :: [FieldName] -&gt; result -&gt; RowIdentityExtractor
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#mkRowIdentityExtractor"><span class="hs-identifier hs-var hs-var">mkRowIdentityExtractor</span></a></span></span><span> </span><span id="local-6989586621679119275"><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621679119275"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679119274"><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119274"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-643"></span><span>  </span><span class="annot"><span class="annottext">(Row -&gt; IO [(ByteString, SqlValue)]) -&gt; RowIdentityExtractor
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#RowIdentityExtractor"><span class="hs-identifier hs-var">RowIdentityExtractor</span></a></span><span> </span><span class="annot"><span class="annottext">((Row -&gt; IO [(ByteString, SqlValue)]) -&gt; RowIdentityExtractor)
-&gt; (Row -&gt; IO [(ByteString, SqlValue)]) -&gt; RowIdentityExtractor
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679119273"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119273"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-644"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679119272"><span class="annot"><span class="annottext">fieldNameSet :: Set ByteString
</span><a href="#local-6989586621679119272"><span class="hs-identifier hs-var hs-var">fieldNameSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-645"></span><span>          </span><span class="annot"><span class="annottext">[ByteString] -&gt; Set ByteString
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span>
</span><span id="line-646"></span><span>            </span><span class="annot"><span class="annottext">([ByteString] -&gt; Set ByteString)
-&gt; ([FieldName] -&gt; [ByteString]) -&gt; [FieldName] -&gt; Set ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; ByteString) -&gt; [FieldName] -&gt; [ByteString]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; ByteString
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldNameToByteString"><span class="hs-identifier hs-var">fieldNameToByteString</span></a></span><span>
</span><span id="line-647"></span><span>            </span><span class="annot"><span class="annottext">([FieldName] -&gt; Set ByteString) -&gt; [FieldName] -&gt; Set ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621679119275"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span>        </span><span id="local-6989586621679119270"><span class="annot"><span class="annottext">getIdentityValue :: Column -&gt; IO (Maybe (ByteString, SqlValue))
</span><a href="#local-6989586621679119270"><span class="hs-identifier hs-var hs-var">getIdentityValue</span></a></span></span><span> </span><span id="local-6989586621679119269"><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119269"><span class="hs-identifier hs-var">columnNumber</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-650"></span><span>          </span><span id="local-6989586621679119268"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679119268"><span class="hs-identifier hs-var">mbColumnName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">result -&gt; Column -&gt; IO (Maybe ByteString)
forall result.
ExecutionResult result =&gt;
result -&gt; Column -&gt; IO (Maybe ByteString)
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#columnName"><span class="hs-identifier hs-var">Result.columnName</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119274"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119269"><span class="hs-identifier hs-var">columnNumber</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679119268"><span class="hs-identifier hs-var">mbColumnName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-653"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679119267"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119267"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Set ByteString -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119267"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Set ByteString
</span><a href="#local-6989586621679119272"><span class="hs-identifier hs-var">fieldNameSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-654"></span><span>              </span><span id="local-6989586621679119265"><span class="annot"><span class="annottext">SqlValue
</span><a href="#local-6989586621679119265"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">result -&gt; Row -&gt; Column -&gt; IO SqlValue
forall result.
ExecutionResult result =&gt;
result -&gt; Row -&gt; Column -&gt; IO SqlValue
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#getValue"><span class="hs-identifier hs-var">Result.getValue</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119274"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679119273"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119269"><span class="hs-identifier hs-var">columnNumber</span></a></span><span>
</span><span id="line-655"></span><span>              </span><span class="annot"><span class="annottext">Maybe (ByteString, SqlValue) -&gt; IO (Maybe (ByteString, SqlValue))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ByteString, SqlValue) -&gt; IO (Maybe (ByteString, SqlValue)))
-&gt; Maybe (ByteString, SqlValue)
-&gt; IO (Maybe (ByteString, SqlValue))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ByteString, SqlValue) -&gt; Maybe (ByteString, SqlValue)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679119267"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SqlValue
</span><a href="#local-6989586621679119265"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>            </span><span class="annot"><span class="annottext">Maybe ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-657"></span><span>              </span><span class="annot"><span class="annottext">Maybe (ByteString, SqlValue) -&gt; IO (Maybe (ByteString, SqlValue))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ByteString, SqlValue)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span>    </span><span id="local-6989586621679119264"><span class="annot"><span class="annottext">Maybe Column
</span><a href="#local-6989586621679119264"><span class="hs-identifier hs-var">mbMaxColumn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">result -&gt; IO (Maybe Column)
forall result.
ExecutionResult result =&gt;
result -&gt; IO (Maybe Column)
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#maxColumnNumber"><span class="hs-identifier hs-var">Result.maxColumnNumber</span></a></span><span> </span><span class="annot"><span class="annottext">result
</span><a href="#local-6989586621679119274"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Column
</span><a href="#local-6989586621679119264"><span class="hs-identifier hs-var">mbMaxColumn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-662"></span><span>      </span><span class="annot"><span class="annottext">Maybe Column
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-663"></span><span>        </span><span class="annot"><span class="annottext">[(ByteString, SqlValue)] -&gt; IO [(ByteString, SqlValue)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-664"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679119263"><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119263"><span class="hs-identifier hs-var">maxColumn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-665"></span><span>        </span><span class="annot"><span class="annottext">([Maybe (ByteString, SqlValue)] -&gt; [(ByteString, SqlValue)])
-&gt; IO [Maybe (ByteString, SqlValue)] -&gt; IO [(ByteString, SqlValue)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (ByteString, SqlValue)] -&gt; [(ByteString, SqlValue)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">(IO [Maybe (ByteString, SqlValue)] -&gt; IO [(ByteString, SqlValue)])
-&gt; IO [Maybe (ByteString, SqlValue)] -&gt; IO [(ByteString, SqlValue)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Column -&gt; IO (Maybe (ByteString, SqlValue)))
-&gt; [Column] -&gt; IO [Maybe (ByteString, SqlValue)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Column -&gt; IO (Maybe (ByteString, SqlValue))
</span><a href="#local-6989586621679119270"><span class="hs-identifier hs-var">getIdentityValue</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Column
</span><a href="Orville.PostgreSQL.Internal.ExecutionResult.html#Column"><span class="hs-identifier hs-var">Column</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679119263"><span class="hs-identifier hs-var">maxColumn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-666"></span><span>
</span><span id="line-667"></span><span class="hs-comment">{- |
  Builds a 'SqlMarshaller' that maps a single field of a Haskell entity to
  a single column in the database. That value to store in the database will
  be retried from the entity using provided accessor function. This function
  is intended to be used inside of a stanza of 'Applicative' syntax that will
  pass values read from the database a constructor function to rebuild the
  entity containing the field, like so:

  @

  data Foo = Foo { bar :: Int32, baz :: Text }

  fooMarshaller :: SqlMarshaller Foo Foo
  fooMarshaller =
    Foo
      &lt;$&gt; marshallField bar (integerField &quot;bar&quot;)
      &lt;*&gt; marshallField baz (unboundedTextField &quot;baz&quot;)

  @
-}</span><span>
</span><span id="line-687"></span><span id="local-6989586621679119260"><span id="local-6989586621679119261"><span id="local-6989586621679119262"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallField"><span class="hs-identifier hs-type">marshallField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-688"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119262"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119261"><span class="hs-identifier hs-type">fieldValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-689"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119260"><span class="hs-identifier hs-type">nullability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119261"><span class="hs-identifier hs-type">fieldValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-690"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119262"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119261"><span class="hs-identifier hs-type">fieldValue</span></a></span></span></span></span><span>
</span><span id="line-691"></span><span id="marshallField"><span class="annot"><span class="annottext">marshallField :: (writeEntity -&gt; fieldValue)
-&gt; FieldDefinition nullability fieldValue
-&gt; SqlMarshaller writeEntity fieldValue
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallField"><span class="hs-identifier hs-var hs-var">marshallField</span></a></span></span><span> </span><span id="local-6989586621679119259"><span class="annot"><span class="annottext">writeEntity -&gt; fieldValue
</span><a href="#local-6989586621679119259"><span class="hs-identifier hs-var">accessor</span></a></span></span><span> </span><span id="local-6989586621679119258"><span class="annot"><span class="annottext">FieldDefinition nullability fieldValue
</span><a href="#local-6989586621679119258"><span class="hs-identifier hs-var">fieldDef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-692"></span><span>  </span><span class="annot"><span class="annottext">(writeEntity -&gt; fieldValue)
-&gt; SqlMarshaller fieldValue fieldValue
-&gt; SqlMarshaller writeEntity fieldValue
forall a b c. (a -&gt; b) -&gt; SqlMarshaller b c -&gt; SqlMarshaller a c
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallNest"><span class="hs-identifier hs-var">MarshallNest</span></a></span><span> </span><span class="annot"><span class="annottext">writeEntity -&gt; fieldValue
</span><a href="#local-6989586621679119259"><span class="hs-identifier hs-var">accessor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDefinition nullability fieldValue
-&gt; SqlMarshaller fieldValue fieldValue
forall nullability a.
FieldDefinition nullability a -&gt; SqlMarshaller a a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallField"><span class="hs-identifier hs-var">MarshallField</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability fieldValue
</span><a href="#local-6989586621679119258"><span class="hs-identifier hs-var">fieldDef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="hs-comment">{- |
  Builds a 'SqlMarshaller' that will include a SQL expression in select
  statements to calculate a value the columns of the table being selected
  from. The columns being used in the calculation do not themselves need
  to be selected, though they must be present in the table so they can
  be referenced.

  @
  data AgeCheck
    { atLeast21 :: Bool
    }

  fooMarshaller :: SqlMarshaller Void AgeCheck
  fooMarshaller =
    AgeCheck
      &lt;*&gt; Orville.marshallSyntheticField atLeast21Field

  atLeast21Field :: SyntheticField Bool
  atLeast21Field =
    SyntheticField
      { syntheticFieldExpression = RawSql.unsafeFromRawSql $ RawSql.fromString &quot;age &gt;= 21&quot;
      , syntheticFieldAlias = Orville.stringToFieldName &quot;over21&quot;
      , syntheticFieldValueFromSqlValue = SqlValue.toBool
      }
  @
-}</span><span>
</span><span id="line-720"></span><span id="local-6989586621679119256"><span id="local-6989586621679119257"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallSyntheticField"><span class="hs-identifier hs-type">marshallSyntheticField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-721"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SyntheticField.html#SyntheticField"><span class="hs-identifier hs-type">SyntheticField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119257"><span class="hs-identifier hs-type">fieldValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-722"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119256"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119257"><span class="hs-identifier hs-type">fieldValue</span></a></span></span></span><span>
</span><span id="line-723"></span><span id="marshallSyntheticField"><span class="annot"><span class="annottext">marshallSyntheticField :: SyntheticField fieldValue -&gt; SqlMarshaller writeEntity fieldValue
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallSyntheticField"><span class="hs-identifier hs-var hs-var">marshallSyntheticField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-724"></span><span>  </span><span class="annot"><span class="annottext">SyntheticField fieldValue -&gt; SqlMarshaller writeEntity fieldValue
forall a b. SyntheticField a -&gt; SqlMarshaller b a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallSyntheticField"><span class="hs-identifier hs-var">MarshallSyntheticField</span></a></span><span>
</span><span id="line-725"></span><span>
</span><span id="line-726"></span><span class="hs-comment">{- |
  Nests a 'SqlMarshaller' inside another, using the given accesser to retrieve
  value to be marshalled. The resulting marshaller can then be used in the same
  way as 'marshallField' within the applicative syntax of a larger marshaller.

  For Example:

  @
  data Person =
    Person
      { personId :: PersonId
      , personName :: Name
      }

  data Name =
    Name
      { firstName :: T.Text
      , lastName :: T.Text
      }

  personMarshaller :: SqlMarshaller Person Person
  personMarshaller =
    Person
      &lt;$&gt; marshallField personId personIdField
      &lt;*&gt; marshallNested personName nameMarshaller

  nameMarshaller :: SqlMarshaller Name Name
  nameMarshaller =
    Name
      &lt;$&gt; marshallField firstName firstNameField
      &lt;*&gt; marshallField lastName lastNameField
  @
-}</span><span>
</span><span id="line-759"></span><span id="local-6989586621679119253"><span id="local-6989586621679119254"><span id="local-6989586621679119255"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallNested"><span class="hs-identifier hs-type">marshallNested</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-760"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679119255"><span class="hs-identifier hs-type">parentEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679119254"><span class="hs-identifier hs-type">nestedWriteEntity</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-761"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119254"><span class="hs-identifier hs-type">nestedWriteEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119253"><span class="hs-identifier hs-type">nestedReadEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-762"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119255"><span class="hs-identifier hs-type">parentEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119253"><span class="hs-identifier hs-type">nestedReadEntity</span></a></span></span></span></span><span>
</span><span id="line-763"></span><span id="marshallNested"><span class="annot"><span class="annottext">marshallNested :: (parentEntity -&gt; nestedWriteEntity)
-&gt; SqlMarshaller nestedWriteEntity nestedReadEntity
-&gt; SqlMarshaller parentEntity nestedReadEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallNested"><span class="hs-identifier hs-var hs-var">marshallNested</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-764"></span><span>  </span><span class="annot"><span class="annottext">(parentEntity -&gt; nestedWriteEntity)
-&gt; SqlMarshaller nestedWriteEntity nestedReadEntity
-&gt; SqlMarshaller parentEntity nestedReadEntity
forall a b c. (a -&gt; b) -&gt; SqlMarshaller b c -&gt; SqlMarshaller a c
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallNest"><span class="hs-identifier hs-var">MarshallNest</span></a></span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="hs-comment">{- |
  Lifts a 'SqlMarshaller' to have both read/write entities be 'Maybe',
  and applies a tag to avoid double mapping.
-}</span><span>
</span><span id="line-770"></span><span id="local-6989586621679119251"><span id="local-6989586621679119252"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallMaybe"><span class="hs-identifier hs-type">marshallMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119252"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119251"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679119252"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679119251"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-771"></span><span id="marshallMaybe"><span class="annot"><span class="annottext">marshallMaybe :: SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallMaybe"><span class="hs-identifier hs-var hs-var">marshallMaybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-772"></span><span>  </span><span class="hs-comment">-- rewrite the mapper to handle null fields, then tag</span><span>
</span><span id="line-773"></span><span>  </span><span class="hs-comment">-- it as having been done so we don't double-map it</span><span>
</span><span id="line-774"></span><span>  </span><span class="hs-comment">-- in a future 'maybeMapper' call.</span><span>
</span><span id="line-775"></span><span>  </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b.
SqlMarshaller (Maybe a) (Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe b)
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallMaybeTag"><span class="hs-identifier hs-var">MarshallMaybeTag</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlMarshaller (Maybe a) (Maybe b)
 -&gt; SqlMarshaller (Maybe a) (Maybe b))
-&gt; (SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b))
-&gt; SqlMarshaller a b
-&gt; SqlMarshaller (Maybe a) (Maybe b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b. SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119250"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-776"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-777"></span><span>    </span><span id="local-6989586621679119625"><span id="local-6989586621679119626"><span class="annot"><a href="#local-6989586621679119250"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119626"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119625"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679119626"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679119625"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-778"></span><span>    </span><span id="local-6989586621679119250"><span class="annot"><span class="annottext">go :: SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119250"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679119249"><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119249"><span class="hs-identifier hs-var">marshaller</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-779"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119249"><span class="hs-identifier hs-var">marshaller</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-780"></span><span>        </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPure"><span class="hs-identifier hs-type">MarshallPure</span></a></span><span> </span><span id="local-6989586621679119248"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679119248"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-781"></span><span>          </span><span class="annot"><span class="annottext">Maybe b -&gt; SqlMarshaller (Maybe a) (Maybe b)
forall b a. b -&gt; SqlMarshaller a b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPure"><span class="hs-identifier hs-var">MarshallPure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe b -&gt; SqlMarshaller (Maybe a) (Maybe b))
-&gt; Maybe b -&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe b
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679119248"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-782"></span><span>        </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallApply"><span class="hs-identifier hs-type">MarshallApply</span></a></span><span> </span><span id="local-6989586621679119247"><span class="annot"><span class="annottext">SqlMarshaller a (b -&gt; b)
</span><a href="#local-6989586621679119247"><span class="hs-identifier hs-var">func</span></a></span></span><span> </span><span id="local-6989586621679119246"><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119246"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-783"></span><span>          </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b -&gt; Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b c.
SqlMarshaller a (b -&gt; c) -&gt; SqlMarshaller a b -&gt; SqlMarshaller a c
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallApply"><span class="hs-identifier hs-var">MarshallApply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe (b -&gt; b) -&gt; Maybe b -&gt; Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe (b -&gt; b))
-&gt; SqlMarshaller (Maybe a) (Maybe b -&gt; Maybe b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Maybe (b -&gt; b) -&gt; Maybe b -&gt; Maybe b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">(&lt;*&gt;)</span></span><span> </span><span class="annot"><span class="annottext">(SqlMarshaller (Maybe a) (Maybe (b -&gt; b))
 -&gt; SqlMarshaller (Maybe a) (Maybe b -&gt; Maybe b))
-&gt; SqlMarshaller (Maybe a) (Maybe (b -&gt; b))
-&gt; SqlMarshaller (Maybe a) (Maybe b -&gt; Maybe b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (b -&gt; b)
-&gt; SqlMarshaller (Maybe a) (Maybe (b -&gt; b))
forall a b. SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119250"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (b -&gt; b)
</span><a href="#local-6989586621679119247"><span class="hs-identifier hs-var">func</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b. SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119250"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119246"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>        </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallNest"><span class="hs-identifier hs-type">MarshallNest</span></a></span><span> </span><span id="local-6989586621679119245"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679119245"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679119244"><span class="annot"><span class="annottext">SqlMarshaller b b
</span><a href="#local-6989586621679119244"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-785"></span><span>          </span><span class="annot"><span class="annottext">(Maybe a -&gt; Maybe b)
-&gt; SqlMarshaller (Maybe b) (Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b c. (a -&gt; b) -&gt; SqlMarshaller b c -&gt; SqlMarshaller a c
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallNest"><span class="hs-identifier hs-var">MarshallNest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679119245"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SqlMarshaller b b -&gt; SqlMarshaller (Maybe b) (Maybe b)
forall a b. SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119250"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller b b
</span><a href="#local-6989586621679119244"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-786"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallMaybeTag"><span class="hs-identifier hs-type">MarshallMaybeTag</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-787"></span><span>          </span><span class="annot"><span class="annottext">b -&gt; Maybe b
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Maybe b)
-&gt; SqlMarshaller (Maybe (Maybe a)) b
-&gt; SqlMarshaller (Maybe (Maybe a)) (Maybe b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Maybe a) -&gt; Maybe a)
-&gt; SqlMarshaller (Maybe a) b -&gt; SqlMarshaller (Maybe (Maybe a)) b
forall a b c. (a -&gt; b) -&gt; SqlMarshaller b c -&gt; SqlMarshaller a c
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallNest"><span class="hs-identifier hs-var">MarshallNest</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe a) -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b
SqlMarshaller (Maybe a) b
</span><a href="#local-6989586621679119249"><span class="hs-identifier hs-var">marshaller</span></a></span><span>
</span><span id="line-788"></span><span>        </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallField"><span class="hs-identifier hs-type">MarshallField</span></a></span><span> </span><span id="local-6989586621679119242"><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119242"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-789"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a -&gt; FieldNullability a
forall nullability a.
FieldDefinition nullability a -&gt; FieldNullability a
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#fieldNullability"><span class="hs-identifier hs-var">fieldNullability</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119242"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-790"></span><span>            </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#NotNullField"><span class="hs-identifier hs-type">NotNullField</span></a></span><span> </span><span id="local-6989586621679119241"><span class="annot"><span class="annottext">FieldDefinition NotNull a
</span><a href="#local-6989586621679119241"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldDefinition Nullable (Maybe a)
-&gt; SqlMarshaller (Maybe a) (Maybe a)
forall nullability a.
FieldDefinition nullability a -&gt; SqlMarshaller a a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallField"><span class="hs-identifier hs-var">MarshallField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDefinition NotNull a -&gt; FieldDefinition Nullable (Maybe a)
forall a.
FieldDefinition NotNull a -&gt; FieldDefinition Nullable (Maybe a)
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#nullableField"><span class="hs-identifier hs-var">nullableField</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition NotNull a
</span><a href="#local-6989586621679119241"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>            </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#NullableField"><span class="hs-identifier hs-type">NullableField</span></a></span><span> </span><span id="local-6989586621679119240"><span class="annot"><span class="annottext">FieldDefinition Nullable a
</span><a href="#local-6989586621679119240"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldDefinition Nullable (Maybe a)
-&gt; SqlMarshaller (Maybe a) (Maybe a)
forall nullability a.
FieldDefinition nullability a -&gt; SqlMarshaller a a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallField"><span class="hs-identifier hs-var">MarshallField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDefinition Nullable a -&gt; FieldDefinition Nullable (Maybe a)
forall a.
FieldDefinition Nullable a -&gt; FieldDefinition Nullable (Maybe a)
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#asymmetricNullableField"><span class="hs-identifier hs-var">asymmetricNullableField</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition Nullable a
</span><a href="#local-6989586621679119240"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>        </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallSyntheticField"><span class="hs-identifier hs-type">MarshallSyntheticField</span></a></span><span> </span><span id="local-6989586621679119239"><span class="annot"><span class="annottext">SyntheticField b
</span><a href="#local-6989586621679119239"><span class="hs-identifier hs-var">synthField</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-793"></span><span>          </span><span class="annot"><span class="annottext">SyntheticField (Maybe b) -&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b. SyntheticField a -&gt; SqlMarshaller b a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallSyntheticField"><span class="hs-identifier hs-var">MarshallSyntheticField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyntheticField b -&gt; SyntheticField (Maybe b)
forall a. SyntheticField a -&gt; SyntheticField (Maybe a)
</span><a href="Orville.PostgreSQL.Internal.SyntheticField.html#nullableSyntheticField"><span class="hs-identifier hs-var">nullableSyntheticField</span></a></span><span> </span><span class="annot"><span class="annottext">SyntheticField b
</span><a href="#local-6989586621679119239"><span class="hs-identifier hs-var">synthField</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>        </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPartial"><span class="hs-identifier hs-type">MarshallPartial</span></a></span><span> </span><span id="local-6989586621679119238"><span class="annot"><span class="annottext">SqlMarshaller a (Either String b)
</span><a href="#local-6989586621679119238"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-795"></span><span>          </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Either String (Maybe b))
-&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b. SqlMarshaller a (Either String b) -&gt; SqlMarshaller a b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPartial"><span class="hs-identifier hs-var">MarshallPartial</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe (Either String b) -&gt; Either String (Maybe b))
-&gt; SqlMarshaller (Maybe a) (Maybe (Either String b))
-&gt; SqlMarshaller (Maybe a) (Either String (Maybe b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Either String b) -&gt; Either String (Maybe b)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">(SqlMarshaller (Maybe a) (Maybe (Either String b))
 -&gt; SqlMarshaller (Maybe a) (Either String (Maybe b)))
-&gt; SqlMarshaller (Maybe a) (Maybe (Either String b))
-&gt; SqlMarshaller (Maybe a) (Either String (Maybe b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (Either String b)
-&gt; SqlMarshaller (Maybe a) (Maybe (Either String b))
forall a b. SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119250"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (Either String b)
</span><a href="#local-6989586621679119238"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>        </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallReadOnly"><span class="hs-identifier hs-type">MarshallReadOnly</span></a></span><span> </span><span id="local-6989586621679119236"><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119236"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-797"></span><span>          </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b c. SqlMarshaller a b -&gt; SqlMarshaller c b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallReadOnly"><span class="hs-identifier hs-var">MarshallReadOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b. SqlMarshaller a b -&gt; SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119250"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119236"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span class="hs-comment">{- |
  Builds a 'SqlMarshaller' that will raise a decoding error when the value
  produced is a 'Left'.
-}</span><span>
</span><span id="line-803"></span><span id="local-6989586621679119234"><span id="local-6989586621679119235"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallPartial"><span class="hs-identifier hs-type">marshallPartial</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119235"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679119234"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119235"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119234"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-804"></span><span id="marshallPartial"><span class="annot"><span class="annottext">marshallPartial :: SqlMarshaller a (Either String b) -&gt; SqlMarshaller a b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallPartial"><span class="hs-identifier hs-var hs-var">marshallPartial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (Either String b) -&gt; SqlMarshaller a b
forall a b. SqlMarshaller a (Either String b) -&gt; SqlMarshaller a b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPartial"><span class="hs-identifier hs-var">MarshallPartial</span></a></span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span class="hs-comment">{- |
  Adds a prefix, followed by an underscore, to the names of all of the fields
  and synthetic fields in a 'SqlMarshaller'.
-}</span><span>
</span><span id="line-810"></span><span id="local-6989586621679119232"><span id="local-6989586621679119233"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#prefixMarshaller"><span class="hs-identifier hs-type">prefixMarshaller</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-811"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-812"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119233"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119232"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-813"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119233"><span class="hs-identifier hs-type">readEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119232"><span class="hs-identifier hs-type">writeEntity</span></a></span></span></span><span>
</span><span id="line-814"></span><span id="prefixMarshaller"><span class="annot"><span class="annottext">prefixMarshaller :: String
-&gt; SqlMarshaller readEntity writeEntity
-&gt; SqlMarshaller readEntity writeEntity
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#prefixMarshaller"><span class="hs-identifier hs-var hs-var">prefixMarshaller</span></a></span></span><span> </span><span id="local-6989586621679119231"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679119231"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller readEntity writeEntity
-&gt; SqlMarshaller readEntity writeEntity
forall a b. SqlMarshaller a b -&gt; SqlMarshaller a b
</span><a href="#local-6989586621679119230"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-816"></span><span>    </span><span id="local-6989586621679119591"><span id="local-6989586621679119592"><span class="annot"><a href="#local-6989586621679119230"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119592"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119591"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119592"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119591"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-817"></span><span>    </span><span id="local-6989586621679119230"><span class="annot"><span class="annottext">go :: SqlMarshaller a b -&gt; SqlMarshaller a b
</span><a href="#local-6989586621679119230"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679119229"><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119229"><span class="hs-identifier hs-var">marshaller</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119229"><span class="hs-identifier hs-var">marshaller</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-818"></span><span>      </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPure"><span class="hs-identifier hs-type">MarshallPure</span></a></span><span> </span><span id="local-6989586621679119228"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679119228"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; SqlMarshaller a b
forall b a. b -&gt; SqlMarshaller a b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPure"><span class="hs-identifier hs-var">MarshallPure</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679119228"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-819"></span><span>      </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallApply"><span class="hs-identifier hs-type">MarshallApply</span></a></span><span> </span><span id="local-6989586621679119227"><span class="annot"><span class="annottext">SqlMarshaller a (b -&gt; b)
</span><a href="#local-6989586621679119227"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679119226"><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119226"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-820"></span><span>        </span><span class="annot"><span class="annottext">SqlMarshaller a (b -&gt; b) -&gt; SqlMarshaller a b -&gt; SqlMarshaller a b
forall a b c.
SqlMarshaller a (b -&gt; c) -&gt; SqlMarshaller a b -&gt; SqlMarshaller a c
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallApply"><span class="hs-identifier hs-var">MarshallApply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SqlMarshaller a (b -&gt; b) -&gt; SqlMarshaller a (b -&gt; b)
forall a b. SqlMarshaller a b -&gt; SqlMarshaller a b
</span><a href="#local-6989586621679119230"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (b -&gt; b)
</span><a href="#local-6989586621679119227"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SqlMarshaller a b -&gt; SqlMarshaller a b)
-&gt; SqlMarshaller a b -&gt; SqlMarshaller a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b -&gt; SqlMarshaller a b
forall a b. SqlMarshaller a b -&gt; SqlMarshaller a b
</span><a href="#local-6989586621679119230"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119226"><span class="hs-identifier hs-var">m2</span></a></span><span>
</span><span id="line-821"></span><span>      </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallNest"><span class="hs-identifier hs-type">MarshallNest</span></a></span><span> </span><span id="local-6989586621679119225"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679119225"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679119224"><span class="annot"><span class="annottext">SqlMarshaller b b
</span><a href="#local-6989586621679119224"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-822"></span><span>        </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; SqlMarshaller b b -&gt; SqlMarshaller a b
forall a b c. (a -&gt; b) -&gt; SqlMarshaller b c -&gt; SqlMarshaller a c
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallNest"><span class="hs-identifier hs-var">MarshallNest</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679119225"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlMarshaller b b -&gt; SqlMarshaller a b)
-&gt; SqlMarshaller b b -&gt; SqlMarshaller a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller b b -&gt; SqlMarshaller b b
forall a b. SqlMarshaller a b -&gt; SqlMarshaller a b
</span><a href="#local-6989586621679119230"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller b b
</span><a href="#local-6989586621679119224"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-823"></span><span>      </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallField"><span class="hs-identifier hs-type">MarshallField</span></a></span><span> </span><span id="local-6989586621679119223"><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119223"><span class="hs-identifier hs-var">fieldDefinition</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-824"></span><span>        </span><span class="annot"><span class="annottext">FieldDefinition nullability a -&gt; SqlMarshaller a a
forall nullability a.
FieldDefinition nullability a -&gt; SqlMarshaller a a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallField"><span class="hs-identifier hs-var">MarshallField</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldDefinition nullability a -&gt; SqlMarshaller a a)
-&gt; FieldDefinition nullability a -&gt; SqlMarshaller a a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; FieldDefinition nullability a -&gt; FieldDefinition nullability a
forall nullability a.
String
-&gt; FieldDefinition nullability a -&gt; FieldDefinition nullability a
</span><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#prefixField"><span class="hs-identifier hs-var">prefixField</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679119231"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability a
</span><a href="#local-6989586621679119223"><span class="hs-identifier hs-var">fieldDefinition</span></a></span><span>
</span><span id="line-825"></span><span>      </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallSyntheticField"><span class="hs-identifier hs-type">MarshallSyntheticField</span></a></span><span> </span><span id="local-6989586621679119222"><span class="annot"><span class="annottext">SyntheticField b
</span><a href="#local-6989586621679119222"><span class="hs-identifier hs-var">syntheticField</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-826"></span><span>        </span><span class="annot"><span class="annottext">SyntheticField b -&gt; SqlMarshaller a b
forall a b. SyntheticField a -&gt; SqlMarshaller b a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallSyntheticField"><span class="hs-identifier hs-var">MarshallSyntheticField</span></a></span><span> </span><span class="annot"><span class="annottext">(SyntheticField b -&gt; SqlMarshaller a b)
-&gt; SyntheticField b -&gt; SqlMarshaller a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; SyntheticField b -&gt; SyntheticField b
forall a. String -&gt; SyntheticField a -&gt; SyntheticField a
</span><a href="Orville.PostgreSQL.Internal.SyntheticField.html#prefixSyntheticField"><span class="hs-identifier hs-var">prefixSyntheticField</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679119231"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">SyntheticField b
</span><a href="#local-6989586621679119222"><span class="hs-identifier hs-var">syntheticField</span></a></span><span>
</span><span id="line-827"></span><span>      </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallMaybeTag"><span class="hs-identifier hs-type">MarshallMaybeTag</span></a></span><span> </span><span id="local-6989586621679119221"><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119221"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b.
SqlMarshaller (Maybe a) (Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe b)
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallMaybeTag"><span class="hs-identifier hs-var">MarshallMaybeTag</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlMarshaller (Maybe a) (Maybe b)
 -&gt; SqlMarshaller (Maybe a) (Maybe b))
-&gt; SqlMarshaller (Maybe a) (Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
-&gt; SqlMarshaller (Maybe a) (Maybe b)
forall a b. SqlMarshaller a b -&gt; SqlMarshaller a b
</span><a href="#local-6989586621679119230"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller (Maybe a) (Maybe b)
</span><a href="#local-6989586621679119221"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-828"></span><span>      </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPartial"><span class="hs-identifier hs-type">MarshallPartial</span></a></span><span> </span><span id="local-6989586621679119220"><span class="annot"><span class="annottext">SqlMarshaller a (Either String b)
</span><a href="#local-6989586621679119220"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (Either String b) -&gt; SqlMarshaller a b
forall a b. SqlMarshaller a (Either String b) -&gt; SqlMarshaller a b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallPartial"><span class="hs-identifier hs-var">MarshallPartial</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlMarshaller a (Either String b) -&gt; SqlMarshaller a b)
-&gt; SqlMarshaller a (Either String b) -&gt; SqlMarshaller a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (Either String b)
-&gt; SqlMarshaller a (Either String b)
forall a b. SqlMarshaller a b -&gt; SqlMarshaller a b
</span><a href="#local-6989586621679119230"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a (Either String b)
</span><a href="#local-6989586621679119220"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-829"></span><span>      </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallReadOnly"><span class="hs-identifier hs-type">MarshallReadOnly</span></a></span><span> </span><span id="local-6989586621679119219"><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119219"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b -&gt; SqlMarshaller a b
forall a b c. SqlMarshaller a b -&gt; SqlMarshaller c b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallReadOnly"><span class="hs-identifier hs-var">MarshallReadOnly</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlMarshaller a b -&gt; SqlMarshaller a b)
-&gt; SqlMarshaller a b -&gt; SqlMarshaller a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b -&gt; SqlMarshaller a b
forall a b. SqlMarshaller a b -&gt; SqlMarshaller a b
</span><a href="#local-6989586621679119230"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b
</span><a href="#local-6989586621679119219"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span class="hs-comment">{- |
  Marks a 'SqlMarshaller' as ready only so that it will not attempt to
  read any values from the @writeEntity@. You should use this if you have
  a group of fields which are populated by database rather than the application.
-}</span><span>
</span><span id="line-836"></span><span id="local-6989586621679119216"><span id="local-6989586621679119217"><span id="local-6989586621679119218"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallReadOnly"><span class="hs-identifier hs-type">marshallReadOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119217"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119216"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119217"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-837"></span><span id="marshallReadOnly"><span class="annot"><span class="annottext">marshallReadOnly :: SqlMarshaller a b -&gt; SqlMarshaller c b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallReadOnly"><span class="hs-identifier hs-var hs-var">marshallReadOnly</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller a b -&gt; SqlMarshaller c b
forall a b c. SqlMarshaller a b -&gt; SqlMarshaller c b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallReadOnly"><span class="hs-identifier hs-var">MarshallReadOnly</span></a></span><span>
</span><span id="line-838"></span><span>
</span><span id="line-839"></span><span class="hs-comment">{- |
  A version of 'marshallField' that uses 'marshallReadOnly' to make a single
  read only field. You will usually use this in conjuction with a
  'FieldDefinition' like @serialField@ where the valuue is populated by the
  database.
-}</span><span>
</span><span id="line-845"></span><span id="local-6989586621679119213"><span id="local-6989586621679119214"><span id="local-6989586621679119215"><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallReadOnlyField"><span class="hs-identifier hs-type">marshallReadOnlyField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-846"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.FieldDefinition.html#FieldDefinition"><span class="hs-identifier hs-type">FieldDefinition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119215"><span class="hs-identifier hs-type">nullability</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119214"><span class="hs-identifier hs-type">fieldValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-847"></span><span>  </span><span class="annot"><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#SqlMarshaller"><span class="hs-identifier hs-type">SqlMarshaller</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119213"><span class="hs-identifier hs-type">writeEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679119214"><span class="hs-identifier hs-type">fieldValue</span></a></span></span></span></span><span>
</span><span id="line-848"></span><span id="marshallReadOnlyField"><span class="annot"><span class="annottext">marshallReadOnlyField :: FieldDefinition nullability fieldValue
-&gt; SqlMarshaller writeEntity fieldValue
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#marshallReadOnlyField"><span class="hs-identifier hs-var hs-var">marshallReadOnlyField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlMarshaller fieldValue fieldValue
-&gt; SqlMarshaller writeEntity fieldValue
forall a b c. SqlMarshaller a b -&gt; SqlMarshaller c b
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallReadOnly"><span class="hs-identifier hs-var">MarshallReadOnly</span></a></span><span> </span><span class="annot"><span class="annottext">(SqlMarshaller fieldValue fieldValue
 -&gt; SqlMarshaller writeEntity fieldValue)
-&gt; (FieldDefinition nullability fieldValue
    -&gt; SqlMarshaller fieldValue fieldValue)
-&gt; FieldDefinition nullability fieldValue
-&gt; SqlMarshaller writeEntity fieldValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FieldDefinition nullability fieldValue
-&gt; SqlMarshaller fieldValue fieldValue
forall nullability a.
FieldDefinition nullability a -&gt; SqlMarshaller a a
</span><a href="Orville.PostgreSQL.Internal.SqlMarshaller.html#MarshallField"><span class="hs-identifier hs-var">MarshallField</span></a></span><span>
</span><span id="line-849"></span></pre></body></html>